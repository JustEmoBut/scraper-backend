<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechPrice Admin Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        .header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: #f1f5f9;
            padding: 1rem 2rem;
            box-shadow: 
                0 4px 20px rgba(0,0,0,0.2),
                0 1px 3px rgba(0,0,0,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(20px) saturate(1.8);
            -webkit-backdrop-filter: blur(20px) saturate(1.8);
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .header h1 {
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: all 0.3s var(--gentle-spring);
        }

        .header h1 i {
            transition: all 0.3s var(--spring-easing);
        }

        @media (prefers-reduced-motion: no-preference) {
            .header h1:hover {
                transform: translateX(4px);
            }

            .header h1:hover i {
                transform: rotate(10deg) scale(1.1);
            }
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: linear-gradient(145deg, #1e293b, #2d3748);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 
                0 4px 20px rgba(0,0,0,0.15),
                0 1px 3px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            position: relative;
            transition: all 0.4s var(--gentle-spring);
            backface-visibility: hidden;
            transform: translateZ(0);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            opacity: 0;
            transition: opacity 0.3s var(--gentle-spring);
        }

        @media (prefers-reduced-motion: no-preference) {
            .card:hover {
                transform: translateY(-4px) scale(1.01);
                box-shadow: 
                    0 12px 40px rgba(0,0,0,0.2),
                    0 4px 12px rgba(0,0,0,0.1),
                    inset 0 1px 0 rgba(255,255,255,0.1);
                border-color: rgba(255,255,255,0.15);
            }

            .card:hover::before {
                opacity: 1;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .card:hover {
                border-color: rgba(255,255,255,0.2);
            }
        }

        .card h3 {
            margin-bottom: 1rem;
            color: #f1f5f9;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-online { background: #10b981; }
        .status-offline { background: #ef4444; }
        .status-warning { background: #f59e0b; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            background: #0f172a;
            border-radius: 8px;
            border: 1px solid #334155;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #60a5fa;
            transition: all 0.3s var(--gentle-spring);
            position: relative;
        }

        .stat-number:hover {
            transform: scale(1.05);
            color: #3b82f6;
        }

        @media (prefers-reduced-motion: reduce) {
            .stat-number:hover {
                transform: none;
                color: #3b82f6;
            }
        }

        .stat-label {
            font-size: 0.875rem;
            color: #94a3b8;
            margin-top: 0.25rem;
        }

        /* Loading states and micro-interactions */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255,255,255,0.1), 
                transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.05) 25%, 
                rgba(255,255,255,0.1) 50%, 
                rgba(255,255,255,0.05) 75%);
            background-size: 200% 100%;
            animation: skeletonLoad 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes skeletonLoad {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Page transition effects */
        .page-transition {
            opacity: 0;
            transform: translateY(20px);
            animation: pageEnter 0.6s var(--spring-easing) forwards;
        }

        @keyframes pageEnter {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Staggered animations for dashboard cards */
        .dashboard-grid .card:nth-child(1) { animation-delay: 0.1s; }
        .dashboard-grid .card:nth-child(2) { animation-delay: 0.2s; }
        .dashboard-grid .card:nth-child(3) { animation-delay: 0.3s; }
        .dashboard-grid .card:nth-child(4) { animation-delay: 0.4s; }

        /* Pulse animation for active states */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Enhanced status indicators */
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
            position: relative;
            animation: statusPulse 2s infinite;
        }

        .status-indicator::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 50%;
            opacity: 0;
            animation: statusRipple 2s infinite;
        }

        .status-online::before {
            background: rgba(16, 185, 129, 0.3);
        }

        .status-warning::before {
            background: rgba(245, 158, 11, 0.3);
        }

        .status-offline::before {
            background: rgba(239, 68, 68, 0.3);
        }

        @keyframes statusRipple {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            50% {
                opacity: 1;
                transform: scale(1.2);
            }
            100% {
                opacity: 0;
                transform: scale(1.4);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .loading::before {
                animation: none;
            }
            
            .skeleton {
                animation: none;
                background: rgba(255,255,255,0.05);
            }
            
            .page-transition {
                animation: none;
                opacity: 1;
                transform: none;
            }
            
            .status-indicator {
                animation: none;
            }
            
            .status-indicator::before {
                animation: none;
                opacity: 0;
            }
            
            .pulse {
                animation: none;
            }
        }

        /* Remove number input arrows */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        input[type="number"] {
            -moz-appearance: textfield;
            appearance: textfield;
        }

        .field-help {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-top: 0.25rem;
            font-style: italic;
        }

        /* Admin sections - hidden by default until authentication */
        .admin-section {
            display: none;
        }

        .admin-only {
            display: none;
        }

        /* Enhanced macOS-like animations with spring physics */
        :root {
            --spring-duration: 0.6s;
            --spring-easing: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --quick-spring: cubic-bezier(0.4, 0.0, 0.2, 1);
            --gentle-spring: cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --bounce-spring: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Respect user motion preferences */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        @media (prefers-reduced-motion: no-preference) {
            .card, .btn, .product-card, .modal-content {
                will-change: transform;
            }
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--quick-spring);
            text-decoration: none;
            font-size: 0.875rem;
            position: relative;
            overflow: hidden;
            backface-visibility: hidden;
            transform: translateZ(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        @media (prefers-reduced-motion: no-preference) {
            .btn:hover {
                transform: translateY(-2px) scale(1.02);
                box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                transition: all 0.25s var(--spring-easing);
            }
            
            .btn:active {
                transform: translateY(0) scale(0.98);
                transition: all 0.1s var(--quick-spring);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .btn:hover {
                opacity: 0.9;
            }
            
            .btn:active {
                opacity: 0.8;
            }
        }

        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        /* Enhanced alert animations */
        .alert {
            display: none;
            padding: 1rem 1.5rem;
            border-radius: 16px;
            margin-bottom: 1rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .alert.show {
            display: block;
            animation: alertSlideIn 0.5s var(--spring-easing);
        }

        .alert.hide {
            animation: alertSlideOut 0.3s var(--quick-spring) forwards;
        }

        @keyframes alertSlideIn {
            0% {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            60% {
                opacity: 1;
                transform: translateY(5px) scale(1.02);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes alertSlideOut {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            @keyframes alertSlideIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            
            @keyframes alertSlideOut {
                0% { opacity: 1; }
                100% { opacity: 0; }
            }
        }

        .alert-success {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #34d399;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.1);
        }

        .alert-error {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(239, 68, 68, 0.05));
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #f87171;
            box-shadow: 0 8px 32px rgba(239, 68, 68, 0.1);
        }

        .alert-warning {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(245, 158, 11, 0.05));
            border: 1px solid rgba(245, 158, 11, 0.3);
            color: #fbbf24;
            box-shadow: 0 8px 32px rgba(245, 158, 11, 0.1);
        }

        .alert-info {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(59, 130, 246, 0.05));
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #60a5fa;
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(20px) saturate(1.8);
            -webkit-backdrop-filter: blur(20px) saturate(1.8);
            z-index: 9999;
            animation: modalFadeIn 0.4s var(--gentle-spring);
        }

        .modal.closing {
            animation: modalFadeIn 0.3s var(--gentle-spring) reverse;
        }

        /* Enhanced modal animations with spring physics */
        @keyframes modalFadeIn {
            0% { 
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            100% { 
                opacity: 1;
                backdrop-filter: blur(12px);
            }
        }

        @keyframes modalSlideIn {
            0% { 
                opacity: 0;
                transform: translate(-50%, -45%) scale(0.9) rotateX(10deg);
                filter: blur(10px);
            }
            60% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.02) rotateX(-2deg);
                filter: blur(0px);
            }
            100% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1) rotateX(0deg);
                filter: blur(0px);
            }
        }

        @keyframes modalSlideOut {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -60%) scale(0.85);
            }
        }

        /* Reduced motion alternatives for modals */
        @media (prefers-reduced-motion: reduce) {
            @keyframes modalFadeIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            
            @keyframes modalSlideIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            
            @keyframes modalSlideOut {
                0% { opacity: 1; }
                100% { opacity: 0; }
            }
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #1e293b 0%, #2d3748 100%);
            border-radius: 20px;
            min-width: 450px;
            max-width: 90vw;
            max-height: 90vh;
            border: 1px solid rgba(255,255,255,0.15);
            box-shadow: 
                0 32px 64px rgba(0,0,0,0.25),
                0 16px 32px rgba(0,0,0,0.15),
                0 8px 16px rgba(0,0,0,0.1),
                0 0 0 1px rgba(255,255,255,0.05),
                inset 0 1px 0 rgba(255,255,255,0.1);
            animation: modalSlideIn 0.6s var(--bounce-spring);
            overflow: hidden;
            perspective: 1000px;
        }

        .modal-content.closing {
            animation: modalSlideOut 0.3s var(--quick-spring) forwards;
        }

        .modal-header {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            padding: 1.5rem 2rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .modal-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }

        .modal-header h2 {
            color: #ffffff;
            margin: 0;
            font-size: 1.25rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .modal-header i {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .modal-body {
            padding: 2rem;
            background: #1e293b;
            max-height: calc(90vh - 120px);
            overflow-y: auto;
        }

        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: #0f172a;
            border-radius: 4px;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #475569, #334155);
            border-radius: 4px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #64748b, #475569);
        }

        .close {
            background: rgba(255,255,255,0.1);
            border: none;
            color: #ffffff;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s var(--spring-easing);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            backdrop-filter: blur(8px);
            position: relative;
            overflow: hidden;
        }

        .close::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s var(--spring-easing);
        }

        @media (prefers-reduced-motion: no-preference) {
            .close:hover {
                background: rgba(255,255,255,0.2);
                transform: scale(1.1) rotate(90deg);
            }

            .close:hover::before {
                width: 100%;
                height: 100%;
            }

            .close:active {
                transform: scale(0.9) rotate(90deg);
                transition: all 0.1s var(--quick-spring);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .close:hover {
                background: rgba(255,255,255,0.25);
            }
        }

        .search-input {
            width: 100%;
            padding: 1rem 1.25rem;
            background: linear-gradient(145deg, #0f172a, #1e293b);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            color: #e2e8f0;
            font-size: 1rem;
            transition: all 0.3s var(--gentle-spring);
            box-shadow: 
                inset 0 2px 4px rgba(0,0,0,0.2),
                0 1px 3px rgba(0,0,0,0.1);
        }

        @media (prefers-reduced-motion: no-preference) {
            .search-input:focus {
                outline: none;
                border-color: #3b82f6;
                box-shadow: 
                    0 0 0 4px rgba(59, 130, 246, 0.2),
                    inset 0 2px 4px rgba(0,0,0,0.2),
                    0 8px 24px rgba(59, 130, 246, 0.1);
                transform: translateY(-2px) scale(1.01);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .search-input:focus {
                outline: none;
                border-color: #3b82f6;
                box-shadow: 
                    0 0 0 2px rgba(59, 130, 246, 0.5),
                    inset 0 2px 4px rgba(0,0,0,0.2);
            }
        }

        .search-input::placeholder {
            color: #64748b;
            opacity: 0.8;
        }

        /* Modern Card Styles */
        .product-card {
            background: linear-gradient(145deg, #1e293b, #334155);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.4s var(--gentle-spring);
            position: relative;
            overflow: hidden;
            backface-visibility: hidden;
            transform: translateZ(0);
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        }

        @media (prefers-reduced-motion: no-preference) {
            .product-card:hover {
                transform: translateY(-6px) scale(1.02);
                box-shadow: 
                    0 25px 50px rgba(0,0,0,0.15),
                    0 12px 24px rgba(0,0,0,0.1),
                    0 0 0 1px rgba(59, 130, 246, 0.3),
                    inset 0 1px 0 rgba(255,255,255,0.15);
                border-color: rgba(59, 130, 246, 0.5);
            }

            .product-card:active {
                transform: translateY(-2px) scale(1.01);
                transition: all 0.1s var(--quick-spring);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .product-card:hover {
                border-color: rgba(59, 130, 246, 0.7);
                box-shadow: 
                    0 4px 8px rgba(0,0,0,0.1),
                    0 0 0 2px rgba(59, 130, 246, 0.3);
            }
        }

        .product-card.selected {
            border-color: #10b981 !important;
            background: linear-gradient(145deg, #065f46, #047857) !important;
            box-shadow: 
                0 12px 32px rgba(16, 185, 129, 0.15),
                0 6px 16px rgba(16, 185, 129, 0.1),
                0 0 0 2px rgba(16, 185, 129, 0.4),
                inset 0 1px 0 rgba(255,255,255,0.2);
            animation: selectedPulse 2s infinite;
        }

        @keyframes selectedPulse {
            0%, 100% {
                box-shadow: 
                    0 12px 32px rgba(16, 185, 129, 0.15),
                    0 6px 16px rgba(16, 185, 129, 0.1),
                    0 0 0 2px rgba(16, 185, 129, 0.4),
                    inset 0 1px 0 rgba(255,255,255,0.2);
            }
            50% {
                box-shadow: 
                    0 16px 40px rgba(16, 185, 129, 0.2),
                    0 8px 20px rgba(16, 185, 129, 0.15),
                    0 0 0 3px rgba(16, 185, 129, 0.5),
                    inset 0 1px 0 rgba(255,255,255,0.2);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .product-card.selected {
                animation: none;
                box-shadow: 
                    0 4px 8px rgba(16, 185, 129, 0.2),
                    0 0 0 3px rgba(16, 185, 129, 0.6);
            }
            
            @keyframes selectedPulse {
                0%, 100% { opacity: 1; }
            }
        }

        /* Modern Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        /* Enhanced button micro-interactions */
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s var(--gentle-spring);
            z-index: 1;
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.4s var(--spring-easing);
            z-index: 0;
        }

        @media (prefers-reduced-motion: no-preference) {
            .btn:hover::before {
                left: 100%;
            }

            .btn:hover::after {
                width: 120%;
                height: 120%;
            }

            .btn:active::after {
                width: 100%;
                height: 100%;
                transition: all 0.1s var(--quick-spring);
            }
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-success:hover {
            box-shadow: 0 8px 24px rgba(16, 185, 129, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .btn-danger:hover {
            box-shadow: 0 8px 24px rgba(239, 68, 68, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .btn-warning:hover {
            box-shadow: 0 8px 24px rgba(245, 158, 11, 0.4);
        }

        .btn-info {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: white;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }

        .btn-info:hover {
            box-shadow: 0 8px 24px rgba(6, 182, 212, 0.4);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
        }

        /* Modern Table Styles */
        table {
            background: linear-gradient(145deg, #1e293b, #334155);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        th {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white !important;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        tr:nth-child(even) {
            background: rgba(255,255,255,0.02);
        }

        tr:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        /* Modern Filter/Select Styles */
        select {
            background: linear-gradient(145deg, #0f172a, #1e293b);
            border: 1px solid #334155;
            border-radius: 12px;
            color: #e2e8f0;
            padding: 0.75rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 
                0 0 0 3px rgba(59, 130, 246, 0.3),
                0 4px 12px rgba(59, 130, 246, 0.15);
        }

        select option {
            background: #1e293b;
            color: #e2e8f0;
            padding: 0.5rem;
        }

        /* Manual Matching Modal Styles */
        .manual-matching-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            height: 600px;
        }

        .matching-column {
            display: flex;
            flex-direction: column;
        }

        .matching-column h3 {
            color: #f1f5f9;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #334155;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .matches-container {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: #0f172a;
            border-radius: 8px;
            border: 1px solid #334155;
        }

        .match-item, .potential-match-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: #1e293b;
            border-radius: 8px;
            border: 1px solid #334155;
            transition: all 0.3s ease;
        }

        .match-item:hover, .potential-match-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }

        .match-info {
            flex: 1;
        }

        .match-name {
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
            line-height: 1.3;
        }

        .match-details {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.25rem;
        }

        .confidence-score {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .confidence-score.confidence-high {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .confidence-score.confidence-medium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .confidence-score.confidence-low {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .add-match-btn, .remove-match-btn {
            padding: 0.5rem 0.75rem;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            margin-left: 1rem;
        }

        .add-match-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .add-match-btn:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .remove-match-btn {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .remove-match-btn:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }

        .potential-search-container {
            margin-bottom: 1rem;
        }

        .potential-search-container input {
            width: 100%;
            padding: 0.75rem;
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 6px;
            color: #e2e8f0;
            font-size: 0.9rem;
        }

        .potential-search-container input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }

        .loading, .no-matches, .error {
            text-align: center;
            padding: 2rem;
            color: #94a3b8;
            font-style: italic;
        }

        .error {
            color: #ef4444;
        }

        .no-matches {
            color: #64748b;
        }

        /* Bulk selection styles */
        .match-item-selectable {
            cursor: pointer;
        }

        .match-item-selectable.selected {
            background: #1e3a8a !important;
            border-color: #3b82f6 !important;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25) !important;
        }

        .match-checkbox {
            margin-right: 0.75rem;
            width: 18px;
            height: 18px;
            accent-color: #3b82f6;
            cursor: pointer;
        }

        .bulk-actions {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .btn-sm {
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-secondary {
            background: #475569;
            color: #e2e8f0;
        }

        .btn-secondary:hover {
            background: #334155;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <!-- Admin Panel Authentication -->
    <div id="authModal" class="modal" style="display: block;">
        <div class="modal-content" style="max-width: 350px; padding: 1.5rem;">
            <div style="text-align: center; margin-bottom: 1.5rem;">
                <div style="font-size: 2rem; margin-bottom: 0.75rem;">🔐</div>
                <h2 style="color: #f1f5f9; margin-bottom: 0.5rem; font-size: 1.25rem;">TechPrice Admin Panel</h2>
                <p style="color: #94a3b8; font-size: 0.8rem;">Güvenli erişim için giriş yapın</p>
            </div>
            
            <div style="margin-bottom: 0.75rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0; font-weight: 500; font-size: 0.85rem;">Kullanıcı Adı:</label>
                <input type="text" id="adminUsername" class="search-input" placeholder="Kullanıcı adınızı girin..." onkeypress="if(event.key==='Enter') authenticateAdmin()" style="padding: 0.75rem; font-size: 0.9rem;">
            </div>
            <div style="margin-bottom: 1rem;">
                <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0; font-weight: 500; font-size: 0.85rem;">Şifre:</label>
                <div style="position: relative;">
                    <input type="password" id="adminPassword" class="search-input" placeholder="Şifrenizi girin..." onkeypress="if(event.key==='Enter') authenticateAdmin()" style="padding: 0.75rem; font-size: 0.9rem;">
                    <button type="button" onclick="togglePasswordVisibility('adminPassword')" style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 0.85rem;">
                        <i id="adminPasswordIcon" class="fas fa-eye"></i>
                    </button>
                </div>
            </div>

            <div id="authError" style="display: none; background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; color: #f87171; padding: 0.75rem; border-radius: 6px; margin-bottom: 0.75rem; text-align: center; font-size: 0.85rem;">
                Hatalı şifre! Lütfen doğru admin şifresini girin.
            </div>

            <button onclick="authenticateAdmin()" class="btn btn-primary" style="width: 100%; padding: 0.75rem; font-size: 0.9rem; margin-bottom: 0.75rem;">
                <i class="fas fa-unlock"></i> Giriş Yap
            </button>
            
            <div style="text-align: center;">
                <small style="color: #94a3b8; font-size: 0.75rem;">Admin hesabınızla giriş yapın</small>
            </div>
        </div>
    </div>

    <!-- Specification Manager Modal -->
    <div id="specificationModal" class="modal admin-only">
        <div class="modal-content" style="max-width: 800px; width: 90%;">
            <div class="modal-header">
                <h2><i class="fas fa-microchip"></i> Teknik Özellik Yönetimi</h2>
                <button class="close" onclick="closeSpecificationModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
            
            <!-- Product Search (Optional) -->
            <div style="margin-bottom: 1.5rem;">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                    <label style="color: #e2e8f0; font-weight: 500;">Ürün Arama (İsteğe Bağlı)</label>
                    <button onclick="toggleSearchMode()" id="searchModeBtn" class="btn" style="padding: 0.25rem 0.5rem; background: linear-gradient(135deg, #64748b 0%, #475569 100%); font-size: 0.8rem;">
                        <i class="fas fa-toggle-off"></i> Manuel Mod
                    </button>
                </div>
                <div id="searchContainer" style="display: none;">
                    <div style="display: flex; gap: 0.5rem;">
                        <input type="text" id="productSearch" placeholder="Mevcut ürünlerden ara..." style="flex: 1; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                        <button onclick="searchProducts()" class="btn btn-primary" style="padding: 0.75rem 1rem;">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div id="productSearchResults" style="margin-top: 0.5rem; max-height: 150px; overflow-y: auto;"></div>
                    <div style="margin-top: 0.5rem; padding: 0.5rem; background: #1e293b; border-radius: 4px; border-left: 3px solid #3b82f6;">
                        <small style="color: #94a3b8;">
                            <i class="fas fa-info-circle"></i> 
                            Ürün bulunursa otomatik doldurulur. Bulunamazsa aşağıdaki alanları manuel doldurun.
                        </small>
                    </div>
                </div>
                <div id="manualContainer" style="display: block;">
                    <div style="padding: 0.75rem; background: #065f46; border-radius: 6px; border-left: 4px solid #10b981;">
                        <div style="color: #d1fae5; font-weight: 500; margin-bottom: 0.25rem;">
                            <i class="fas fa-hand-paper"></i> Manuel Mod Aktif
                        </div>
                        <small style="color: #a7f3d0;">
                            Genel teknik özellikler ekleyin. Örnek: "NVIDIA RTX 4070 Ti" veya "AMD Ryzen 7 7700X"
                        </small>
                    </div>
                </div>
            </div>

            <!-- Product Information -->
            <div style="margin-bottom: 1.5rem;">
                <h3 style="color: #f1f5f9; margin-bottom: 1rem;">Ürün Bilgileri</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0;">
                            Ürün Adı 
                            <small style="color: #94a3b8;">(Genel model adı)</small>
                        </label>
                        <input type="text" id="specProductName" placeholder="Örnek: NVIDIA RTX 4070 Ti" style="width: 100%; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                        <small style="color: #94a3b8; margin-top: 0.25rem; display: block;">
                            Spesifik marka modeli değil, genel ürün adı yazın
                        </small>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0;">
                            Ana Marka 
                            <small style="color: #94a3b8;">(Chipset üreticisi)</small>
                        </label>
                        <input type="text" id="specBrand" placeholder="Örnek: NVIDIA, AMD, Intel" style="width: 100%; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                        <small style="color: #94a3b8; margin-top: 0.25rem; display: block;">
                            Kartı yapan değil, çipi yapan markayı yazın
                        </small>
                    </div>
                </div>
                <div style="margin-top: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0;">Kategori</label>
                    <select id="specCategory" onchange="loadSpecificationTemplate()" style="width: 100%; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                        <option value="">Kategori Seçin</option>
                        <option value="İşlemci">İşlemci</option>
                        <option value="Ekran Kartı">Ekran Kartı</option>
                        <option value="Anakart">Anakart</option>
                        <option value="RAM">RAM</option>
                        <option value="SSD">SSD</option>
                        <option value="Güç Kaynağı">Güç Kaynağı</option>
                        <option value="Bilgisayar Kasası">Bilgisayar Kasası</option>
                    </select>
                </div>
            </div>

            <!-- Dynamic Specifications Form -->
            <div id="specificationsForm" style="margin-bottom: 1.5rem;">
                <h3 style="color: #f1f5f9; margin-bottom: 1rem;">Teknik Özellikler</h3>
                <div id="specificationFields"></div>
            </div>

            <!-- Actions -->
            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <button onclick="closeSpecificationModal()" class="btn" style="background: linear-gradient(135deg, #64748b 0%, #475569 100%);">
                    <i class="fas fa-times"></i> İptal
                </button>
                <button onclick="saveSpecification()" class="btn btn-success">
                    <i class="fas fa-save"></i> Kaydet
                </button>
            </div>
            </div>
        </div>
    </div>

    <!-- Specifications List Modal -->
    <div id="specificationsListModal" class="modal">
        <div class="modal-content" style="max-width: 1200px; width: 95%;">
            <div class="modal-header">
                <h2><i class="fas fa-list"></i> Teknik Özellikler Listesi</h2>
                <button class="close" onclick="closeSpecificationsListModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
            
            <!-- Filters -->
            <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                <select id="filterCategory" onchange="filterSpecifications()" style="padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                    <option value="">Tüm Kategoriler</option>
                    <option value="İşlemci">İşlemci</option>
                    <option value="Ekran Kartı">Ekran Kartı</option>
                    <option value="Anakart">Anakart</option>
                    <option value="RAM">RAM</option>
                    <option value="SSD">SSD</option>
                    <option value="Güç Kaynağı">Güç Kaynağı</option>
                    <option value="Bilgisayar Kasası">Bilgisayar Kasası</option>
                </select>
                <input type="text" id="filterSearch" placeholder="Ürün adı ile ara..." onkeyup="filterSpecifications()" style="flex: 1; padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 6px; color: #e2e8f0;">
                <button onclick="loadSpecificationsList()" class="btn btn-primary" style="padding: 0.5rem 1rem;">
                    <i class="fas fa-sync"></i> Yenile
                </button>
            </div>
            
            <!-- Specifications List -->
            <div id="specificationsList" style="max-height: 600px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>


    <!-- Manual Matching Modal -->
    <div id="manualMatchingModal" class="modal">
        <div class="modal-content" style="max-width: 95vw; max-height: 90vh; width: 1600px;">
            <div class="modal-header">
                <h2><i class="fas fa-link"></i> Manuel Ürün Eşleştirmesi</h2>
                <button class="close" onclick="closeManualMatchingModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" style="max-height: 80vh; overflow-y: auto;">
                <!-- Enhanced Specification Info with Feature Breakdown -->
                <div id="specInfo" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; border: 1px solid #334155;">
                    <div style="display: grid; grid-template-columns: 1fr 300px; gap: 1.5rem; align-items: start;">
                        <!-- Product Information -->
                        <div>
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div style="background: #3b82f6; color: white; width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                    <i class="fas fa-microchip"></i>
                                </div>
                                <div>
                                    <h3 id="specProductName" style="color: #f1f5f9; margin: 0; font-size: 1.2rem; font-weight: 600;">Ürün Yükleniyor...</h3>
                                    <p id="specProductCategory" style="color: #94a3b8; margin: 0; font-size: 0.9rem;">Kategori bilgisi yükleniyor...</p>
                                </div>
                            </div>
                            
                            <!-- Key Features Breakdown -->
                            <div id="keyFeaturesBreakdown" style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                                <h4 style="color: #60a5fa; margin: 0 0 0.75rem 0; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fas fa-key"></i> Eşleştirme Özellikleri
                                </h4>
                                <div id="featuresGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
                                    <!-- Features will be populated here -->
                                </div>
                            </div>
                            
                            <!-- Performance Stats -->
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                <div style="text-align: center; padding: 0.75rem; background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 6px;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #10b981;" id="totalMatches">0</div>
                                    <div style="font-size: 0.8rem; color: #94a3b8;">Toplam Eşleşme</div>
                                </div>
                                <div style="text-align: center; padding: 0.75rem; background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 6px;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #f59e0b;" id="avgConfidence">0%</div>
                                    <div style="font-size: 0.8rem; color: #94a3b8;">Ortalama Güven</div>
                                </div>
                                <div style="text-align: center; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 6px;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: #3b82f6;" id="lastMatched">-</div>
                                    <div style="font-size: 0.8rem; color: #94a3b8;">Son Eşleşme</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Debug Information -->
                        <div style="background: rgba(15, 23, 42, 0.8); border: 1px solid #334155; border-radius: 8px; padding: 1rem;">
                            <h4 style="color: #94a3b8; margin: 0 0 0.75rem 0; font-size: 0.85rem; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-bug"></i> Debug Bilgileri
                            </h4>
                            <div style="font-size: 0.8rem; color: #64748b; line-height: 1.4;">
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>Spec ID:</strong> <span id="debugSpecId" style="font-family: monospace; color: #8b5cf6;">-</span>
                                </div>
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>Algoritma:</strong> <span style="color: #10b981;">HIZLI v2.0</span>
                                </div>
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>Son Güncelleme:</strong> <span id="debugLastUpdate">-</span>
                                </div>
                                <div style="margin-bottom: 0.5rem;">
                                    <strong>Durum:</strong> <span id="debugStatus" style="color: #10b981;">Aktif</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Two Column Layout -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; height: 65vh;">
                    <!-- Current Matches -->
                    <div style="display: flex; flex-direction: column;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="color: #f1f5f9; margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-check-circle" style="color: #10b981;"></i>
                                Mevcut Eşleşmeler (<span id="currentMatchCount">0</span>)
                            </h3>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-secondary" onclick="selectAllCurrentMatches()" style="font-size: 0.8rem; padding: 0.375rem 0.75rem;">
                                    <i class="fas fa-check-square"></i> Tümünü Seç
                                </button>
                                <button class="btn btn-sm btn-danger" onclick="removeSelectedMatches()" style="font-size: 0.8rem; padding: 0.375rem 0.75rem;">
                                    <i class="fas fa-trash"></i> Seçilenleri Kaldır (<span id="selectedCurrentCount">0</span>)
                                </button>
                            </div>
                        </div>
                        <div id="currentMatches" style="flex: 1; overflow-y: auto; border: 1px solid #334155; border-radius: 8px; padding: 0.75rem; background: #0f172a;">
                            <!-- Current matches will be loaded here -->
                        </div>
                    </div>
                    
                    <!-- Potential Matches -->
                    <div style="display: flex; flex-direction: column;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="color: #f1f5f9; margin: 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-search" style="color: #3b82f6;"></i>
                                Potansiyel Eşleşmeler (<span id="potentialMatchCount">0</span>)
                            </h3>
                            <div style="display: flex; gap: 0.5rem;">
                                <button class="btn btn-sm btn-secondary" onclick="selectAllPotentialMatches()" style="font-size: 0.8rem; padding: 0.375rem 0.75rem;">
                                    <i class="fas fa-check-square"></i> Tümünü Seç
                                </button>
                                <button class="btn btn-sm btn-success" onclick="addSelectedMatches()" style="font-size: 0.8rem; padding: 0.375rem 0.75rem;">
                                    <i class="fas fa-plus"></i> Seçilenleri Ekle (<span id="selectedPotentialCount">0</span>)
                                </button>
                            </div>
                        </div>
                        
                        <!-- Search and Filter Controls -->
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
                            <input type="text" id="potentialMatchSearch" placeholder="Ürün adı ile ara..." 
                                   oninput="onPotentialMatchSearch()" 
                                   style="flex: 1; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: #e2e8f0;"
                                   class="search-input">
                            <select id="potentialSortBy" onchange="onPotentialMatchSearch()" 
                                    style="padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: #e2e8f0;">
                                <option value="similarity">Benzerlik</option>
                                <option value="price">Fiyat</option>
                                <option value="name">İsim</option>
                            </select>
                        </div>
                        
                        <div id="potentialMatches" style="flex: 1; overflow-y: auto; border: 1px solid #334155; border-radius: 8px; padding: 0.75rem; background: #0f172a;">
                            <!-- Potential matches will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="header">
        <h1>
            <i class="fas fa-chart-line"></i>
            TechPrice Admin Panel
        </h1>
        <div class="admin-only" style="display: flex; align-items: center; gap: 1rem;">
            <span id="currentUserDisplay" style="color: #94a3b8; font-size: 0.9rem;"></span>
            <button onclick="adminLogout()" class="btn" style="padding: 0.5rem 1rem; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; font-size: 0.8rem;">
                <i class="fas fa-sign-out-alt"></i> Çıkış
            </button>
        </div>
    </div>

    <div class="main-container admin-section">
        <!-- Alert Messages -->
        <div id="alertSuccess" class="alert alert-success">
            <i class="fas fa-check-circle"></i> İşlem başarıyla tamamlandı!
        </div>
        <div id="alertError" class="alert alert-error">
            <i class="fas fa-exclamation-triangle"></i> <span id="errorMessage">Bir hata oluştu!</span>
        </div>

        <div class="dashboard-grid">
            <!-- System Status -->
            <div class="card">
                <h3><i class="fas fa-server"></i> Sistem Durumu</h3>
                <div style="margin-bottom: 1rem;">
                    <div style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                        <span class="status-indicator" id="dbStatus"></span>
                        <span id="dbStatusText">Kontrol ediliyor...</span>
                    </div>
                </div>
            </div>

            <!-- Statistics -->
            <div class="card">
                <h3><i class="fas fa-chart-bar"></i> İstatistikler</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div id="totalProducts" class="stat-number">-</div>
                        <div class="stat-label">Toplam Ürün</div>
                    </div>
                    <div class="stat-item">
                        <div id="totalCategories" class="stat-number">-</div>
                        <div class="stat-label">Kategori</div>
                    </div>
                    <div class="stat-item">
                        <div id="totalSites" class="stat-number">3</div>
                        <div class="stat-label">Site</div>
                    </div>
                    <div class="stat-item">
                        <div id="avgPrice" class="stat-number">-</div>
                        <div class="stat-label">Ort. Fiyat (₺)</div>
                    </div>
                </div>
            </div>

            <!-- API Operations -->
            <div class="card">
                <h3><i class="fas fa-cogs"></i> API İşlemleri</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="loadStatistics()">
                        <i class="fas fa-sync"></i> İstatistikleri Yenile
                    </button>
                    <button class="btn btn-success" onclick="checkSystemStatus()">
                        <i class="fas fa-heartbeat"></i> Sistem Kontrolü
                    </button>
                </div>
            </div>

            <!-- Teknik Özellikler Yönetimi -->
            <div class="card">
                <h3><i class="fas fa-microchip"></i> Teknik Özellikler</h3>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="showSpecificationManager()">
                        <i class="fas fa-plus"></i> Özellik Ekle
                    </button>
                    <button class="btn btn-info" onclick="viewSpecifications()">
                        <i class="fas fa-list"></i> Özellikleri Görüntüle
                    </button>
                    <button class="btn btn-danger" onclick="viewUnmatchedProducts()">
                        <i class="fas fa-exclamation-triangle"></i> Eksik Özellikler
                    </button>
                    <button class="btn btn-success" onclick="viewCoverageStats()">
                        <i class="fas fa-chart-bar"></i> Kapsam İstatistikleri
                    </button>
                    <!-- Manuel eşleştirme artık yeterli, otomatik butonlar kaldırıldı -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced animation system with performance optimization
        const AnimationManager = {
            prefersReducedMotion: window.matchMedia('(prefers-reduced-motion: reduce)').matches,
            
            init() {
                this.setupScrollIndicator();
                this.setupPageTransitions();
                this.setupIntersectionObserver();
                this.enhanceFormInputs();
                this.setupGlobalEventListeners();
            },
            
            setupScrollIndicator() {
                const indicator = document.createElement('div');
                indicator.className = 'scroll-indicator';
                document.body.appendChild(indicator);
                
                let ticking = false;
                const updateScrollIndicator = () => {
                    const scrolled = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                    indicator.style.transform = `scaleX(${Math.min(scrolled / 100, 1)})`;
                    ticking = false;
                };
                
                window.addEventListener('scroll', () => {
                    if (!ticking) {
                        requestAnimationFrame(updateScrollIndicator);
                        ticking = true;
                    }
                });
            },
            
            setupPageTransitions() {
                document.querySelectorAll('.card').forEach((el, index) => {
                    el.classList.add('page-transition');
                    if (!this.prefersReducedMotion) {
                        el.style.animationDelay = `${index * 0.1}s`;
                    }
                });
            },
            
            setupIntersectionObserver() {
                if (this.prefersReducedMotion) return;
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.style.animation = 'pageEnter 0.6s var(--spring-easing) forwards';
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1, rootMargin: '50px' });
                
                document.querySelectorAll('.card:not(.page-transition)').forEach(card => {
                    observer.observe(card);
                });
            },
            
            enhanceFormInputs() {
                document.addEventListener('focusin', (e) => {
                    if (e.target.matches('input, select, textarea')) {
                        this.animateInputFocus(e.target, true);
                    }
                });
                
                document.addEventListener('focusout', (e) => {
                    if (e.target.matches('input, select, textarea')) {
                        this.animateInputFocus(e.target, false);
                    }
                });
            },
            
            animateInputFocus(input, isFocused) {
                if (this.prefersReducedMotion) return;
                
                if (isFocused) {
                    input.style.transform = 'translateY(-1px) scale(1.01)';
                    input.style.transition = 'all 0.3s var(--gentle-spring)';
                } else {
                    input.style.transform = 'translateY(0) scale(1)';
                }
            },
            
            setupGlobalEventListeners() {
                // Enhanced button interactions
                document.addEventListener('mousedown', (e) => {
                    if (e.target.matches('.btn')) {
                        this.animateButtonPress(e.target, true);
                    }
                });
                
                document.addEventListener('mouseup', (e) => {
                    if (e.target.matches('.btn')) {
                        this.animateButtonPress(e.target, false);
                    }
                });
            },
            
            animateButtonPress(button, isPressed) {
                if (this.prefersReducedMotion) return;
                
                if (isPressed) {
                    button.style.transform = 'translateY(1px) scale(0.98)';
                    button.style.transition = 'all 0.1s var(--quick-spring)';
                } else {
                    button.style.transform = '';
                    button.style.transition = 'all 0.3s var(--spring-easing)';
                }
            },
            
            showAlert(message, type = 'info') {
                const alertContainer = document.getElementById('alertContainer') || this.createAlertContainer();
                
                const alert = document.createElement('div');
                alert.className = `alert alert-${type}`;
                alert.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.75rem;">
                        ${type === 'success' ? '<div class="success-checkmark"></div>' : ''}
                        <span>${message}</span>
                        <button onclick="this.parentElement.parentElement.remove()" 
                                style="margin-left: auto; background: none; border: none; color: inherit; cursor: pointer; opacity: 0.7;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                
                alertContainer.appendChild(alert);
                
                // Trigger entrance animation
                requestAnimationFrame(() => {
                    alert.classList.add('show');
                });
                
                // Auto remove after 4 seconds
                setTimeout(() => {
                    alert.classList.add('hide');
                    setTimeout(() => alert.remove(), 300);
                }, 4000);
                
                return alert;
            },
            
            createAlertContainer() {
                const container = document.createElement('div');
                container.id = 'alertContainer';
                container.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    z-index: 10000;
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                    pointer-events: none;
                `;
                container.addEventListener('click', (e) => e.stopPropagation());
                container.style.pointerEvents = 'auto';
                document.body.appendChild(container);
                return container;
            },
            
            modalTransition(modal, action = 'open') {
                const modalContent = modal.querySelector('.modal-content');
                
                if (action === 'open') {
                    modal.style.display = 'block';
                    if (!this.prefersReducedMotion) {
                        requestAnimationFrame(() => {
                            modal.style.animation = 'modalFadeIn 0.4s var(--gentle-spring)';
                            modalContent.style.animation = 'modalSlideIn 0.6s var(--bounce-spring)';
                        });
                    }
                } else {
                    if (!this.prefersReducedMotion) {
                        modal.classList.add('closing');
                        modalContent.classList.add('closing');
                        setTimeout(() => {
                            modal.style.display = 'none';
                            modal.classList.remove('closing');
                            modalContent.classList.remove('closing');
                        }, 300);
                    } else {
                        modal.style.display = 'none';
                    }
                }
            },
            
            // Loading state animations
            showLoading(element, text = 'Yükleniyor...') {
                if (!element) return;
                
                element.classList.add('loading');
                const originalContent = element.innerHTML;
                element.dataset.originalContent = originalContent;
                
                element.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
                        <div style="width: 16px; height: 16px; border: 2px solid transparent; border-top: 2px solid currentColor; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        ${text}
                    </div>
                `;
            },
            
            hideLoading(element) {
                if (!element) return;
                
                element.classList.remove('loading');
                const originalContent = element.dataset.originalContent;
                if (originalContent) {
                    element.innerHTML = originalContent;
                    delete element.dataset.originalContent;
                }
            }
        };
        
        // Initialize animation system when DOM loads
        document.addEventListener('DOMContentLoaded', () => {
            AnimationManager.init();
        });
        
        // Add CSS for spin animation
        if (!document.querySelector('#spin-keyframes')) {
            const style = document.createElement('style');
            style.id = 'spin-keyframes';
            style.textContent = `
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
            `;
            document.head.appendChild(style);
        }

        const baseURL = window.location.origin;

        // Helper function for safe API calls
        async function safeApiCall(url, options = {}) {
            try {
                // Automatically add authentication token if available
                const token = localStorage.getItem('adminToken');
                if (token && !options.headers?.Authorization) {
                    options.headers = {
                        ...options.headers,
                        'Authorization': `Bearer ${token}`
                    };
                }
                
                const response = await fetch(url, options);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                // Content-Type kontrolü
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    const textResponse = await response.text();
                    console.error('Non-JSON response from:', url, textResponse);
                    throw new Error('Server did not return JSON data');
                }
                
                const data = await response.json();
                return { success: true, data }; // Keep the original format for compatibility
                
            } catch (error) {
                console.error('API call failed:', url, error);
                return { success: false, error: error.message };
            }
        }

        // Authentication
        async function authenticateAdmin() {
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value.trim();
            
            if (!username || !password) {
                showAuthError('Kullanıcı adı ve şifre gerekli!');
                return;
            }

            try {
                const response = await fetch(`${baseURL}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: username,
                        password: password
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    localStorage.setItem('adminToken', data.data.token);
                    localStorage.setItem('adminUser', JSON.stringify(data.data.user));
                    
                    // Update authentication state
                    isAuthenticated = true;
                    currentUser = data.data.user;
                    
                    // Initialize admin interface
                    initializeAdminInterface();
                    
                    showAlert('success', `Hoş geldiniz ${data.data.user.username}!`);
                } else {
                    showAuthError(data.error || 'Giriş başarısız!');
                }
            } catch (error) {
                showAuthError('Bağlantı hatası: ' + error.message);
            }
        }


        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(inputId + 'Icon');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('authError');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // System status check
        async function checkSystemStatus() {
            const dbStatus = document.getElementById('dbStatus');
            const dbStatusText = document.getElementById('dbStatusText');
            
            const result = await safeApiCall(`${baseURL}/api/test-connection`);
            
            if (result.success && result.data.success) {
                dbStatus.className = 'status-indicator status-online';
                dbStatusText.textContent = 'API Çalışıyor';
            } else if (result.success && !result.data.success) {
                dbStatus.className = 'status-indicator status-warning';
                dbStatusText.textContent = 'API Uyarı';
            } else {
                dbStatus.className = 'status-indicator status-offline';
                dbStatusText.textContent = 'API Bağlantı Hatası';
            }
        }

        // Load statistics
        async function loadStatistics() {
            const result = await safeApiCall(`${baseURL}/api/stats`);
            
            if (result.success && result.data.success) {
                const stats = result.data.stats;
                document.getElementById('totalProducts').textContent = 
                    stats.totalProducts?.toLocaleString() || '0';
                document.getElementById('totalCategories').textContent = 
                    stats.totalCategories || '0';
                
                // Calculate average price from averagePrices array
                let avgPrice = '-';
                if (stats.averagePrices && stats.averagePrices.length > 0) {
                    const totalAvg = stats.averagePrices.reduce((sum, item) => sum + (item.avgPrice || 0), 0);
                    avgPrice = Math.round(totalAvg / stats.averagePrices.length);
                }
                document.getElementById('avgPrice').textContent = avgPrice;
            } else {
                // Hata durumunda fallback değerleri
                document.getElementById('totalProducts').textContent = 'Yüklenemedi';
                document.getElementById('totalCategories').textContent = 'Yüklenemedi';
                document.getElementById('avgPrice').textContent = 'Yüklenemedi';
                
                const errorMsg = result.error || (result.data && result.data.error) || 'Bilinmeyen hata';
                console.error('Stats loading failed:', errorMsg);
            }
        }

        function viewApiDocs() {
            document.getElementById('apiDocsModal').style.display = 'flex';
            showApiSection('core'); // Default olarak core section'ı göster
        }

        function closeApiDocsModal() {
            document.getElementById('apiDocsModal').style.display = 'none';
        }

        function showApiSection(section) {
            // Navigation butonlarını güncelle
            document.querySelectorAll('.api-nav-btn').forEach(btn => {
                btn.style.background = 'none';
                btn.style.color = '#94a3b8';
            });
            
            // Aktif butonu vurgula
            event.target.style.background = '#1e293b';
            event.target.style.color = '#e2e8f0';
            
            const content = document.getElementById('apiContent');
            
            const apiSections = {
                core: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-database"></i> Temel Veri API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/categories</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Tüm ürün kategorilerini ve site bilgilerini getirir.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #fbbf24;">Örnek Response:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "success": true,
  "categories": [
    {
      "key": "islemci",
      "name": "İşlemci",
      "sites": ["itopya", "incehesap", "sinerji"]
    }
  ]
}</code></pre>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #8b5cf6;">Kullanım:</strong>
                            <p style="color: #9ca3af; font-size: 0.9rem;">Kategori listesi için frontend uygulamalarında kullanılır.</p>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/data/:category</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Belirli bir kategorideki tüm ürünleri getirir.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Parametreler:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem;">
                                <li><code>category</code>: islemci, ekran-karti, anakart, ram, ssd, guc-kaynagi, bilgisayar-kasasi</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #fbbf24;">Örnek Response:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "success": true,
  "data": [
    {
      "_id": "...",
      "name": "AMD Ryzen 7 7700X",
      "currentPrice": 12500,
      "brand": "AMD",
      "source": "itopya",
      "category": "itopya_islemci",
      "imageUrl": "https://...",
      "scrapedAt": "2024-01-01T00:00:00.000Z"
    }
  ],
  "totalCount": 1250
}</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/stats</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Sistem istatistiklerini ve genel durum bilgilerini getirir.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #fbbf24;">Örnek Response:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "success": true,
  "stats": {
    "totalProducts": 15432,
    "totalCategories": 21,
    "totalSites": 3,
    "lastScrapedAt": "2024-01-01T00:00:00.000Z",
    "averagePrices": [
      {
        "category": "İşlemci",
        "avgPrice": 8500,
        "count": 1250
      }
    ]
  }
}</code></pre>
                        </div>
                    </div>
                `,
                products: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-box"></i> Ürün API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <h4 style="color: #3b82f6; margin-bottom: 1rem;">GET /api/products</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Sayfalama, filtreleme ve sıralama ile ürünleri getirir.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>page</code>: Sayfa numarası (varsayılan: 1)</li>
                                <li><code>limit</code>: Sayfa başına ürün sayısı (varsayılan: 20)</li>
                                <li><code>category</code>: Kategori filtresi</li>
                                <li><code>brand</code>: Marka filtresi</li>
                                <li><code>minPrice</code>: Minimum fiyat</li>
                                <li><code>maxPrice</code>: Maksimum fiyat</li>
                                <li><code>sortBy</code>: Sıralama alanı (currentPrice, scrapedAt, name)</li>
                                <li><code>sortOrder</code>: Sıralama yönü (asc, desc)</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #8b5cf6;">Örnek İstek:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; font-size: 0.8rem; color: #a78bfa; margin-top: 0.5rem;"><code>GET /api/products?page=1&limit=10&category=İşlemci&minPrice=5000&maxPrice=15000&sortBy=currentPrice&sortOrder=asc</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <h4 style="color: #3b82f6; margin-bottom: 1rem;">GET /api/batch/products</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Birden fazla kategori için toplu ürün verisi.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>categories</code>: Virgülle ayrılmış kategori listesi</li>
                                <li><code>limit</code>: Her kategori için limit (varsayılan: 10)</li>
                            </ul>
                        </div>
                    </div>
                `,
                search: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-search"></i> Arama API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="color: #f59e0b; margin-bottom: 1rem;">GET /api/search/:category</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Belirli bir kategoride ürün arama.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Parametreler:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>category</code>: Arama yapılacak kategori</li>
                                <li><code>q</code>: Arama terimi</li>
                                <li><code>limit</code>: Sonuç limiti (varsayılan: 20)</li>
                            </ul>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #8b5cf6;">Örnek İstek:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; font-size: 0.8rem; color: #a78bfa; margin-top: 0.5rem;"><code>GET /api/search/islemci?q=ryzen&limit=10</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="color: #f59e0b; margin-bottom: 1rem;">GET /api/search/all</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Tüm kategorilerde genel arama.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>q</code>: Arama terimi</li>
                                <li><code>limit</code>: Her kategori için limit</li>
                            </ul>
                        </div>
                    </div>
                `,
                analytics: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-chart-bar"></i> Analitik API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                        <h4 style="color: #8b5cf6; margin-bottom: 1rem;">GET /api/analytics/price-trends</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Fiyat trend analizi ve geçmiş veriler.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>category</code>: Kategori filtresi</li>
                                <li><code>days</code>: Kaç günlük veri (varsayılan: 30)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                        <h4 style="color: #8b5cf6; margin-bottom: 1rem;">GET /api/analytics/price-movers</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">En çok fiyat değişikliği olan ürünler.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>type</code>: gainers (yükselenler) veya losers (düşenler)</li>
                                <li><code>limit</code>: Sonuç limiti</li>
                            </ul>
                        </div>
                    </div>
                `,
                specifications: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-microchip"></i> Teknik Özellik API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/specifications</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Tüm teknik özellikleri listele (sayfalama ile).</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>page</code>: Sayfa numarası</li>
                                <li><code>limit</code>: Sayfa başına öğe sayısı</li>
                                <li><code>category</code>: Kategori filtresi</li>
                                <li><code>brand</code>: Marka filtresi</li>
                                <li><code>search</code>: Ürün adı araması</li>
                            </ul>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <h4 style="color: #ef4444; margin-bottom: 1rem;">POST /api/specifications 🔒</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Yeni teknik özellik oluştur (Authentication gerekli).</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #fbbf24;">Örnek Request Body:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "productName": "AMD Ryzen 7 7700X",
  "category": "İşlemci",
  "brand": "AMD",
  "specifications": {
    "cekirdekSayisi": 8,
    "threadSayisi": 16,
    "temelFrekans": 3800,
    "maksimumFrekans": 5400,
    "soket": "AM5"
  }
}</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/specifications/templates</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Tüm kategoriler için özellik şablonları.</p>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 1rem;">GET /api/specifications/unmatched</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Teknik özelliği olmayan ürünleri listele.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Query Parametreleri:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>category</code>: Kategori filtresi</li>
                                <li><code>search</code>: Ürün adı araması</li>
                                <li><code>sortBy</code>: Sıralama alanı</li>
                                <li><code>sortOrder</code>: Sıralama yönü</li>
                            </ul>
                        </div>
                    </div>
                `,
                auth: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-lock"></i> Kimlik Doğrulama API'leri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <h4 style="color: #ef4444; margin-bottom: 1rem;">POST /api/auth/login</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Admin kullanıcı girişi.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #fbbf24;">Request Body:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "username": "admin",
  "password": "şifre"
}</code></pre>
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #10b981;">Response:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>{
  "success": true,
  "data": {
    "token": "jwt-token-here",
    "user": {
      "id": "...",
      "username": "admin",
      "role": "admin"
    }
  }
}</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <h4 style="color: #3b82f6; margin-bottom: 1rem;">GET /api/auth/verify</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">JWT token doğrulama.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Headers:</strong>
                            <pre style="background: #1f2937; padding: 1rem; border-radius: 4px; font-size: 0.8rem; color: #e5e7eb; margin-top: 0.5rem;"><code>Authorization: Bearer jwt-token-here</code></pre>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="color: #f59e0b; margin-bottom: 1rem;">POST /api/auth/register</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Yeni admin kullanıcı oluştur (ilk kullanıcı veya super_admin gerekli).</p>
                    </div>
                `,
                admin: `
                    <h3 style="color: #f1f5f9; margin-bottom: 1.5rem; border-bottom: 2px solid #3b82f6; padding-bottom: 0.5rem;">
                        <i class="fas fa-cog"></i> Admin İşlemleri
                    </h3>
                    
                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <h4 style="color: #ef4444; margin-bottom: 1rem;">POST /api/admin/scrape/:type 🔒</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Scraping işlemlerini başlat.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Parametreler:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>type</code>: all, missing, parallel</li>
                            </ul>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="color: #f59e0b; margin-bottom: 1rem;">POST /api/admin/fix/:type 🔒</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Veri düzeltme işlemleri.</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Parametreler:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>type</code>: duplicates, mapping, all</li>
                            </ul>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #dc2626;">
                        <h4 style="color: #dc2626; margin-bottom: 1rem;">POST /api/admin/reset/:type 🔒⚠️</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Veritabanı sıfırlama işlemleri (TEHLİKELİ).</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong style="color: #ef4444;">Parametreler:</strong>
                            <ul style="color: #9ca3af; margin-left: 1rem; font-size: 0.9rem;">
                                <li><code>type</code>: database, products, site</li>
                            </ul>
                        </div>
                        
                        <div style="padding: 1rem; background: #7f1d1d; border-radius: 4px; border-left: 3px solid #dc2626;">
                            <strong style="color: #fca5a5;">⚠️ UYARI:</strong>
                            <p style="color: #fca5a5; margin: 0; font-size: 0.9rem;">Bu işlemler geri alınamaz veri kaybına neden olabilir!</p>
                        </div>
                    </div>

                    <div class="api-endpoint" style="margin-bottom: 2rem; padding: 1.5rem; background: #0f172a; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <h4 style="color: #3b82f6; margin-bottom: 1rem;">GET /api/debug</h4>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Sistem debug bilgileri ve detaylı durum.</p>
                    </div>

                    <div style="margin-top: 2rem; padding: 1rem; background: #065f46; border-radius: 8px; border-left: 4px solid #10b981;">
                        <h4 style="color: #34d399; margin-bottom: 0.5rem;">📝 Notlar</h4>
                        <ul style="color: #a7f3d0; margin: 0; font-size: 0.9rem;">
                            <li>🔒 simgeli endpoint'ler Authentication gerektirir</li>
                            <li>⚠️ simgeli işlemler tehlikeli operasyonlardır</li>
                            <li>Tüm POST/PUT/DELETE işlemleri JWT token gerektirir</li>
                            <li>Response formatı: <code>{"success": boolean, "data": any, "error": string}</code></li>
                        </ul>
                    </div>
                `
            };
            
            content.innerHTML = apiSections[section] || '<p style="color: #9ca3af;">Bölüm bulunamadı.</p>';
        }

        function showAlert(type, message) {
            if (!message || message === undefined) {
                message = 'Bilinmeyen mesaj';
            }
            
            const alertDiv = document.getElementById(type === 'success' ? 'alertSuccess' : 'alertError');
            
            if (!alertDiv) {
                console.error('Alert div not found for type:', type);
                return;
            }
            
            if (type === 'error') {
                const errorElement = document.getElementById('errorMessage');
                if (errorElement) {
                    errorElement.textContent = message;
                }
            } else {
                alertDiv.innerHTML = '<i class="fas fa-check-circle"></i> ' + message;
            }
            
            alertDiv.style.display = 'block';
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 5000);
        }

        // Authentication state management
        let isAuthenticated = false;
        let currentUser = null;

        // Check authentication status on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
            initializeAdminInterface();
        });

        // Check if user is authenticated and has admin role
        function checkAuthentication() {
            const token = localStorage.getItem('adminToken');
            const user = localStorage.getItem('adminUser');
            
            if (!token || !user) {
                isAuthenticated = false;
                currentUser = null;
                return false;
            }
            
            try {
                // Check if token is expired
                const tokenPayload = JSON.parse(atob(token.split('.')[1]));
                const currentTime = Math.floor(Date.now() / 1000);
                
                if (tokenPayload.exp < currentTime) {
                    clearAuthenticationData();
                    return false;
                }
                
                // Parse user data and check role
                const userData = JSON.parse(user);
                if (!userData.role || (userData.role !== 'admin' && userData.role !== 'super_admin')) {
                    clearAuthenticationData();
                    return false;
                }
                
                isAuthenticated = true;
                currentUser = userData;
                return true;
            } catch (error) {
                console.error('Authentication check error:', error);
                clearAuthenticationData();
                return false;
            }
        }

        // Clear authentication data
        function clearAuthenticationData() {
            localStorage.removeItem('adminToken');
            localStorage.removeItem('adminUser');
            isAuthenticated = false;
            currentUser = null;
        }

        // Require authentication for admin operations
        function requireAuthentication() {
            if (!checkAuthentication()) {
                showAlert('error', 'Bu işlem için admin girişi gerekli!');
                return false;
            }
            return true;
        }

        // Initialize admin interface based on authentication
        function initializeAdminInterface() {
            const authModal = document.getElementById('authModal');
            const adminSections = document.querySelectorAll('.admin-section, .admin-only');
            
            if (checkAuthentication()) {
                // User is authenticated - hide auth modal and show admin sections
                authModal.style.display = 'none';
                adminSections.forEach(section => {
                    // Don't show modals automatically - they should be opened manually
                    if (section.classList.contains('modal')) {
                        section.style.display = 'none';
                    } else {
                        section.style.display = 'block';
                    }
                });
                
                // Update current user display
                const userDisplay = document.getElementById('currentUserDisplay');
                if (userDisplay) {
                    userDisplay.textContent = `${currentUser.username} (${currentUser.role})`;
                }
                
                showAlert('success', `Hoşgeldiniz, ${currentUser.username}!`);
                checkSystemStatus();
                loadStatistics();
            } else {
                // User not authenticated - show auth modal and hide admin sections
                authModal.style.display = 'flex';
                adminSections.forEach(section => {
                    section.style.display = 'none';
                });
                
                // Clear user display
                const userDisplay = document.getElementById('currentUserDisplay');
                if (userDisplay) {
                    userDisplay.textContent = '';
                }
            }
        }

        // Admin logout function
        function adminLogout() {
            if (confirm('Çıkış yapmak istediğinizden emin misiniz?')) {
                clearAuthenticationData();
                initializeAdminInterface();
                showAlert('info', 'Başarıyla çıkış yapıldı.');
            }
        }

        // Specification Management Functions
        let currentSpecifications = [];
        
        // Kategori-özel teknik özellik şablonları
        const specificationTemplates = {
            'İşlemci': [
                { key: 'cekirdekSayisi', label: 'Çekirdek Sayısı', type: 'number', unit: 'adet', help: 'Fiziksel çekirdek sayısını girin (örn: 8)' },
                { key: 'eCekirdekSayisi', label: 'E-Core Sayısı', type: 'number', unit: 'adet', help: 'E-Core sayısını girin (örn: 6)' },
                { key: 'pCekirdekSayisi', label: 'P-Core Sayısı', type: 'number', unit: 'adet', help: 'P-Core sayısını girin (örn: 12)' },
                { key: 'threadSayisi', label: 'Thread Sayısı', type: 'number', unit: 'adet', help: 'Hyperthreading dahil toplam thread sayısı (örn: 16)' },
                { key: 'temelFrekans', label: 'Temel Frekans', type: 'number', unit: 'GHz', help: 'Base clock hızı ondalıklı olarak (örn: 3.8)' },
                { key: 'boostFrekans', label: 'Boost Frekans', type: 'number', unit: 'GHz', help: 'Maksimum turbo boost hızı (örn: 4.6)' },
                { key: 'soket', label: 'Soket', type: 'select', options: ['AM4', 'AM5', 'LGA1700', 'LGA1200', 'LGA1851', 'TR4', 'sTRX4', 'SP3'], help: 'Anakart bağlantı tipi' },
                { key: 'islemciAilesi', label: 'İşlemci Ailesi', type: 'text', help: 'Örn: Zen 4, Raptor Lake, Alder Lake' },
                { key: 'uretimTeknolojisi', label: 'Üretim Teknolojisi', type: 'number', unit: 'nm', help: 'Nanometre cinsinden üretim süreci (örn: 5, 7)' },
                { key: 'l1Cache', label: 'L1 Cache', type: 'number', unit: 'KB', help: 'Level 1 cache boyutu toplam (örn: 640)' },
                { key: 'l2Cache', label: 'L2 Cache', type: 'number', unit: 'MB', help: 'Level 2 cache boyutu toplam (örn: 16)' },
                { key: 'l3Cache', label: 'L3 Cache', type: 'number', unit: 'MB', help: 'Level 3 cache boyutu MB cinsinden' },
                { key: 'overclockDestegi', label: 'Overclock Desteği', type: 'boolean', help: 'Üretici tarafından overclock desteği (K, X, Black Edition)' },
                { key: 'tdp', label: 'TDP', type: 'number', unit: 'W', help: 'Thermal Design Power - güç tüketimi (örn: 65, 105)' },
            ],
            'Ekran Kartı': [
                { key: 'gpu', label: 'GPU', type: 'text', help: 'GPU çip adı (örn: GA104, RDNA 3, Navi 23)' },
                { key: 'bellek', label: 'Bellek', type: 'number', unit: 'GB', help: 'VRAM miktarı GB cinsinden (örn: 8, 12, 16)' },
                { key: 'bellekTipi', label: 'Bellek Tipi', type: 'select', options: ['GDDR7', 'GDDR6X', 'GDDR6', 'GDDR5X', 'GDDR5', 'GDDR4', 'GDDR3', 'GDDR2', 'GDDR', 'DDR4', 'DDR3', 'DDR2', 'DDR', 'SDRAM', 'HBM3E', 'HBM3', 'HBM2E', 'HBM2', 'HBM', 'eDRAM'], help: 'Video bellek teknolojisi (eski kartlar için DDR/SDRAM da dahil)' },
                { key: 'bellekBusGenisligi', label: 'Bellek Bus Genişliği', type: 'select', options: ['32-bit', '64-bit', '96-bit', '128-bit', '160-bit', '192-bit', '224-bit', '256-bit', '288-bit', '320-bit', '352-bit', '384-bit', '448-bit', '512-bit', '1024-bit', '2048-bit', '4096-bit'], help: 'Bellek veri yolu genişliği' },
                { key: 'cudaCekirdek', label: 'CUDA Çekirdek', type: 'number', unit: 'adet', help: 'NVIDIA için CUDA core, AMD için Stream Processor sayısı' },
                { key: 'rtCore', label: 'RT Core', type: 'number', unit: 'adet', help: 'Ray Tracing çekirdek sayısı (NVIDIA)' },
                { key: 'tensorCore', label: 'Tensor Core', type: 'number', unit: 'adet', help: 'AI/ML çekirdek sayısı (NVIDIA)' },
                { key: 'temelSaat', label: 'Temel Saat', type: 'number', unit: 'MHz', help: 'Base clock hızı (örn: 1365, 1700)' },
                { key: 'boostSaat', label: 'Boost Saat', type: 'number', unit: 'MHz', help: 'Boost clock hızı (örn: 1755, 2400)' },
                { key: 'bellekSaati', label: 'Bellek Saati', type: 'number', unit: 'MHz', help: 'VRAM clock hızı (örn: 1313, 1188)' },
                { key: 'gucTuketimi', label: 'Güç Tüketimi', type: 'number', unit: 'W', help: 'TGP/TBP değeri (örn: 220, 320)' },
                { key: 'cikislar', label: 'Çıkışlar', type: 'text', help: 'Video çıkışları (örn: 3x DP 1.4a, 1x HDMI 2.1)' },
            ],
            'Anakart': [
                { key: 'soket', label: 'Soket', type: 'select', options: ['AM4', 'AM5', 'LGA1700', 'LGA1200', 'LGA1851', 'TR4', 'sTRX4', 'SP3'], help: 'İşlemci bağlantı tipi' },
                { key: 'cipset', label: 'Chipset', type: 'text', help: 'Anakart çipset modeli (örn: B550, Z790, X670E)' },
                { key: 'formFaktor', label: 'Form Faktör', type: 'select', options: ['ATX', 'Micro-ATX', 'Mini-ITX', 'E-ATX', 'XL-ATX', 'SSI CEB'], help: 'Anakart boyut standardı' },
                { key: 'ramSlotlari', label: 'RAM Slotları', type: 'number', unit: 'adet', help: 'RAM için DIMM slot sayısı (genelde 2 veya 4)' },
                { key: 'maksRam', label: 'Maksimum RAM', type: 'number', unit: 'GB', help: 'Desteklenen maksimum RAM kapasitesi (örn: 128, 192)' },
                { key: 'ramHizi', label: 'Desteklenen RAM Hızı', type: 'number', unit: 'MHz', help: 'Maksimum desteklenen RAM hızı (örn: 5600, 7200)' },
                { key: 'ramTipi', label: 'RAM Tipi', type: 'select', options: ['DDR5', 'DDR4', 'DDR4/DDR5', 'DDR3', 'DDR2', 'LPDDR5', 'LPDDR4'], help: 'Desteklenen RAM teknolojisi' },
                { key: 'eccDestegi', label: 'ECC Desteği', type: 'boolean', help: 'Error Correcting Code RAM desteği' },
                { key: 'pciSlotlari', label: 'PCI Slotları', type: 'text', help: 'PCI/PCIe slot bilgisi (örn: 1x PCIe 5.0 x16, 2x PCIe 4.0 x1)' },
                { key: 'm2Slotlari', label: 'M.2 Slotları', type: 'number', unit: 'adet', help: 'M.2 SSD için slot sayısı' },
                { key: 'agBaglantisi', label: 'Ağ Bağlantısı', type: 'text', help: 'Ethernet ve WiFi özellikleri (örn: 2.5G LAN, WiFi 6E)' },
                { key: 'wifiDestegi', label: 'WiFi Desteği', type: 'text', help: 'WiFi standardı (örn: WiFi 6E, WiFi 7, WiFi 6)' },
                { key: 'bluetoothDestegi', label: 'Bluetooth Desteği', type: 'text', help: 'Bluetooth sürümü (örn: Bluetooth 5.3, Bluetooth 5.2)' },
                { key: 'isitkorumaKalkanları', label: 'Isı Koruma Kalkanları', type: 'boolean', help: 'M.2 SSD ve VRM için heatsink var mı?' },
                { key: 'overclockDestegi', label: 'Overclock Desteği', type: 'boolean', help: 'CPU/RAM overclock özelliği' }
            ],
            'RAM': [
                { key: 'kapasite', label: 'Kapasite', type: 'number', unit: 'GB', help: 'Toplam RAM kapasitesi (örn: 16, 32)' },
                { key: 'hiz', label: 'Hız', type: 'number', unit: 'MHz', help: 'Efektif hız (örn: 3200, 5600)' },
                { key: 'tip', label: 'Tip', type: 'select', options: ['DDR5', 'DDR4', 'DDR3', 'DDR2', 'DDR', 'LPDDR5X', 'LPDDR5', 'LPDDR4X', 'LPDDR4', 'LPDDR3'], help: 'RAM teknolojisi' },
                { key: 'clDegeri', label: 'CL Değeri', type: 'text', help: 'CAS Latency timing (örn: CL16, CL36)' },
                { key: 'modulSayisi', label: 'Modül Sayısı', type: 'number', unit: 'adet', help: 'Kit içindeki RAM stick sayısı (1, 2, 4)' },
                { key: 'modulBasinaKapasite', label: 'Modül Başına Kapasite', type: 'number', unit: 'GB', help: 'Her bir stick kapasitesi (örn: 8, 16, 32)' },
                { key: 'rank', label: 'Rank', type: 'select', options: ['Single Rank', 'Dual Rank'], help: 'Bellek bank organizasyonu' },
                { key: 'xmpProfili', label: 'XMP Profili', type: 'boolean', help: 'Intel XMP/AMD EXPO profil desteği' },
                { key: 'xmpSurum', label: 'XMP Sürüm', type: 'select', options: ['XMP 2.0', 'XMP 3.0', 'EXPO', 'JEDEC'], help: 'Overclock profil sürümü' },
                { key: 'formFaktor', label: 'Form Faktör', type: 'select', options: ['DIMM', 'SO-DIMM', 'ECC DIMM'], help: 'Fiziksel boyut tipi' },
                { key: 'eccDestegi', label: 'ECC Desteği', type: 'boolean', help: 'Error Correcting Code desteği var mı?' },
            ],
            'SSD': [
                { key: 'kapasite', label: 'Kapasite', type: 'number', unit: 'GB', help: 'Depolama kapasitesi (örn: 500, 1000, 2000)' },
                { key: 'arayuz', label: 'Arayüz', type: 'select', options: ['M.2 NVMe', 'M.2 Sata', 'SATA 3.0'], help: 'Bağlantı arayüzü tipi' },
                { key: 'pcieSurum', label: 'PCIe Sürüm', type: 'select', options: ['PCIe 3.0', 'PCIe 4.0', 'PCIe 5.0', 'SATA'], help: 'PCIe jenerasyon desteği' },
                { key: 'okumaHizi', label: 'Okuma Hızı', type: 'number', unit: 'MB/s', help: 'Sıralı okuma performansı (örn: 7000, 3500)' },
                { key: 'yazmaHizi', label: 'Yazma Hızı', type: 'number', unit: 'MB/s', help: 'Sıralı yazma performansı (örn: 6500, 3000)' },
                { key: 'rastgeleOkuma', label: 'Rastgele Okuma', type: 'number', unit: 'IOPS', help: '4K rastgele okuma performansı (örn: 1000000, 550000)' },
                { key: 'rastgeleYazma', label: 'Rastgele Yazma', type: 'number', unit: 'IOPS', help: '4K rastgele yazma performansı (örn: 900000, 500000)' },
                { key: 'nandTipi', label: 'NAND Tipi', type: 'select', options: ['3D TLC', '3D QLC', '3D MLC', 'V-NAND TLC', 'V-NAND QLC'], help: 'Flash bellek teknolojisi' },
                { key: 'cache', label: 'DRAM Cache', type: 'number', unit: 'MB', help: 'DRAM cache boyutu, yoksa 0 yazın' },
                { key: 'hostMemoryBuffer', label: 'Host Memory Buffer', type: 'boolean', help: 'HMB teknolojisi desteği (DRAM-less SSD\'ler için)' },
                { key: 'tbw', label: 'TBW', type: 'number', unit: 'TB', help: 'Total Bytes Written - dayanıklılık (örn: 600, 1200)' },
                { key: 'formFaktor', label: 'Form Faktör', type: 'select', options: ['M.2 2280', 'M.2 2242', 'M.2 22110', '2.5" SATA', 'U.2', 'mSATA'], help: 'Fiziksel boyut standardı' }
            ],
            'Güç Kaynağı': [
                { key: 'guc', label: 'Güç', type: 'number', unit: 'W', help: 'Maksimum güç kapasitesi (örn: 650, 850, 1000)' },
                { key: 'sertifikasyon', label: 'Sertifikasyon', type: 'select', options: ['80+ Bronze', '80+ Silver', '80+ Gold', '80+ Platinum', '80+ Titanium', '80+ White', 'Yok'], help: 'Enerji verimliliği sertifikası' },
                { key: 'moduler', label: 'Modüler', type: 'select', options: ['Tam Modüler', 'Yarı Modüler', 'Sabit Kablo'], help: 'Kablo bağlantı tipi' },
                { key: 'formFaktor', label: 'Form Faktör', type: 'select', options: ['ATX', 'SFX', 'SFX-L', 'TFX', 'Flex ATX'], help: 'PSU boyut standardı' },
                { key: 'semiPassive', label: 'Semi-Passive', type: 'boolean', help: 'Düşük yükte fan duruyor mu?' },
                { key: 'activePfc', label: 'Active PFC', type: 'boolean', help: 'Active Power Factor Correction desteği' },
                { key: 'rail12vSayisi', label: '+12V Rail Sayısı', type: 'select', options: ['Single Rail', 'Multi Rail', 'Dual Rail'], help: '+12V güç dağılım tipi' },
                { key: 'korumalar', label: 'Koruma Özellikleri', type: 'text', help: 'Güvenlik korumaları (örn: OVP, UVP, OCP, SCP, OTP, OPP)' },
                { key: 'sertifikasyonlar', label: 'Sertifikasyonlar', type: 'text', help: 'Güvenlik sertifikaları (örn: CE, FCC, UL, TÜV, ErP)' }
            ],
            'Bilgisayar Kasası': [
                { key: 'tip', label: 'Tip', type: 'select', options: ['Mid Tower', 'Full Tower', 'Mini-ITX', 'Micro-ATX', 'E-ATX', 'HTPC', 'SFF'], help: 'Kasa boyut kategorisi' },
                { key: 'formFaktor', label: 'Form Faktör', type: 'select', options: ['ATX', 'Micro-ATX', 'Mini-ITX', 'E-ATX', 'XL-ATX'], help: 'Maksimum desteklenen anakart boyutu' },
                { key: 'fanSlotu', label: 'Fan Slotu', type: 'number', unit: 'adet', help: 'Toplam fan monte edilebilecek konum sayısı' },
                { key: 'onFanDestegi', label: 'Ön Fan Desteği', type: 'text', help: 'Ön panel fan desteği (örn: 3x 120mm, 2x 140mm)' },
                { key: 'ustFanDestegi', label: 'Üst Fan Desteği', type: 'text', help: 'Üst panel fan desteği (örn: 2x 120mm, 2x 140mm)' },
                { key: 'arkaFanDestegi', label: 'Arka Fan Desteği', type: 'text', help: 'Arka panel fan desteği (genelde 1x 120mm)' },
                { key: 'yanFanDestegi', label: 'Yan Fan Desteği', type: 'text', help: 'Yan panel fan desteği varsa' },
                { key: 'dahiliFanlar', label: 'Dahili Fanlar', type: 'text', help: 'Kasayla birlikte gelen fanlar (örn: 3x 120mm RGB, 2x 140mm)' },
                { key: 'fanKontrolcusu', label: 'Fan Kontrolcüsü', type: 'boolean', help: 'Dahili fan kontrolcüsü/hub var mı?' },
                { key: 'radiatorDestegi', label: 'Radiatör Desteği', type: 'text', help: 'AIO soğutma desteği (örn: 240mm üst, 360mm ön, 280mm yan)' },
                { key: 'maksRadiatorOlcusu', label: 'Maks. Radiatör Ölçüsü', type: 'select', options: ['120mm', '140mm', '240mm', '280mm', '360mm', '420mm'], help: 'Desteklenen en büyük radiatör boyutu' },
                { key: 'hddSlotu', label: 'HDD Slotu', type: 'number', unit: 'adet', help: '3.5" HDD için slot sayısı' },
                { key: 'ssdSlotu', label: 'SSD Slotu', type: 'number', unit: 'adet', help: '2.5" SSD için slot sayısı' },
                { key: 'cokamacliSlot', label: 'Çokamaçlı Slot', type: 'number', unit: 'adet', help: 'Hem HDD hem SSD alabilecek slot sayısı' },
                { key: 'onPanelKonnektorleri', label: 'Ön Panel Konnektörleri', type: 'text', help: 'Ön panel bağlantıları (örn: 2x USB 3.0, 1x USB-C, Audio)' },
                { key: 'usbTipleri', label: 'USB Tipleri', type: 'text', help: 'USB port detayları (örn: 2x USB 3.2 Gen1, 1x USB 3.2 Gen2 Type-C)' },
                { key: 'audioKonnektoru', label: 'Audio Konnektörü', type: 'select', options: ['3.5mm Combo', '3.5mm Ayrı', 'HD Audio', 'AC97'], help: 'Ses girişi tipi' },
                { key: 'maksEkranKartiUzunlugu', label: 'Maks. Ekran Kartı Uzunluğu', type: 'number', unit: 'mm', help: 'Desteklenen maksimum GPU uzunluğu' },
                { key: 'maksEkranKartiYuksekligi', label: 'Maks. Ekran Kartı Yüksekliği', type: 'number', unit: 'mm', help: 'GPU clearance yüksekliği' },
                { key: 'maksCpuSogutucuYuksekligi', label: 'Maks. CPU Soğutucu Yüksekliği', type: 'number', unit: 'mm', help: 'CPU cooler için maksimum yükseklik clearance' },
                { key: 'maksPsuUzunlugu', label: 'Maks. PSU Uzunluğu', type: 'number', unit: 'mm', help: 'Güç kaynağı için maksimum uzunluk' },
                { key: 'boyutlar', label: 'Boyutlar', type: 'text', help: 'Kasa boyutları Y x G x D (örn: 210 x 460 x 480 mm)' },
                { key: 'camPanel', label: 'Cam Panel', type: 'boolean', help: 'Temperli cam yan panel var mı?' },
                { key: 'camPanelTipi', label: 'Cam Panel Tipi', type: 'select', options: ['Temperli Cam', 'Akrilik', 'Mesh', 'Kapalı'], help: 'Yan panel malzeme tipi' },
                { key: 'mesh', label: 'Mesh Panel', type: 'boolean', help: 'Havalandırma için mesh panel var mı?' },
                { key: 'tolozFiltresi', label: 'Toz Filtresi', type: 'text', help: 'Toz filtreleri konumları (örn: Alt, Ön, Üst)' },
                { key: 'rgb', label: 'RGB Aydınlatma', type: 'boolean', help: 'Dahili RGB aydınlatma sistemi var mı?' },
                { key: 'rgbTipi', label: 'RGB Tipi', type: 'text', help: 'RGB kontrolcü desteği (örn: ASUS Aura, MSI Mystic Light, Corsair iCUE)' },
                { key: 'rgbKonnektoru', label: 'RGB Konnektörü', type: 'text', help: 'RGB bağlantı noktaları (örn: 3x ARGB, 2x RGB)' },
                { key: 'kabloyonetimi', label: 'Kablo Yönetimi', type: 'text', help: 'Kablo düzenleme özellikleri (örn: 25mm clearance, velcro strips, cable grommets)' },
                { key: 'montajTipi', label: 'Montaj Tipi', type: 'select', options: ['Tool-less', 'Vida ile', 'Hibrit'], help: 'Bileşen montaj sistemi' }
            ]
        };

        // Show specification manager modal
        function showSpecificationManager() {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            document.getElementById('specificationModal').style.display = 'flex';
            loadSpecificationTemplates();
        }

        // Close specification manager modal
        function closeSpecificationModal() {
            document.getElementById('specificationModal').style.display = 'none';
            clearSpecificationForm();
        }

        // Show specifications list modal
        function viewSpecifications() {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            document.getElementById('specificationsListModal').style.display = 'flex';
            loadSpecificationsList();
        }

        // Close specifications list modal
        function closeSpecificationsListModal() {
            document.getElementById('specificationsListModal').style.display = 'none';
        }

        // Load specification templates (artık inline templates kullanıyoruz)
        async function loadSpecificationTemplates() {
            // Templates artık inline olarak tanımlı, API'ye gerek yok
        }

        // Load specification template for selected category
        function loadSpecificationTemplate() {
            const category = document.getElementById('specCategory').value;
            const fieldsContainer = document.getElementById('specificationFields');
            
            
            if (!category || !specificationTemplates[category]) {
                fieldsContainer.innerHTML = '';
                return;
            }
            
            const fields = specificationTemplates[category];
            let html = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">';
            
            fields.forEach(field => {
                html += `
                    <div>
                        <label style="display: block; margin-bottom: 0.5rem; color: #e2e8f0; font-size: 0.9rem;">
                            ${field.label} ${field.unit ? `(${field.unit})` : ''}
                        </label>`;
                
                if (field.type === 'select') {
                    html += `<select id="spec_${field.key}" style="width: 100%; padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0; font-size: 0.9rem;">
                        <option value="">Seçin</option>`;
                    field.options.forEach(option => {
                        html += `<option value="${option}">${option}</option>`;
                    });
                    html += `</select>`;
                } else if (field.type === 'boolean') {
                    html += `<select id="spec_${field.key}" style="width: 100%; padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0; font-size: 0.9rem;">
                        <option value="">Seçin</option>
                        <option value="true">Evet</option>
                        <option value="false">Hayır</option>
                    </select>`;
                } else {
                    const inputType = field.type === 'number' ? 'number' : 'text';
                    html += `<input type="${inputType}" id="spec_${field.key}" style="width: 100%; padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0; font-size: 0.9rem;">`;
                }
                
                // Add help text if available
                if (field.help) {
                    html += `<div class="field-help">${field.help}</div>`;
                }
                
                html += `</div>`;
            });
            
            html += '</div>';
            fieldsContainer.innerHTML = html;
            
        }

        // Search products
        async function searchProducts() {
            const query = document.getElementById('productSearch').value.trim();
            const resultsContainer = document.getElementById('productSearchResults');
            
            if (!query) {
                resultsContainer.innerHTML = '';
                return;
            }
            
            try {
                // Use products endpoint instead of search as fallback
                const response = await fetch(`${baseURL}/api/products?search=${encodeURIComponent(query)}&limit=10`);
                const data = await response.json();
                
                if (data.success && data.products && data.products.length > 0) {
                    let html = '<div style="border: 1px solid #334155; border-radius: 6px; background: #0f172a; max-height: 150px; overflow-y: auto;">';
                    
                    data.products.forEach(product => {
                        html += `
                            <div onclick="selectProduct('${product._id}', '${product.name.replace(/'/g, "\\'")}', '${product.category}', '${product.brand || ''}')" 
                                 style="padding: 0.75rem; border-bottom: 1px solid #334155; cursor: pointer; hover:background: #1e293b;"
                                 onmouseover="this.style.background='#1e293b'" 
                                 onmouseout="this.style.background='transparent'">
                                <div style="font-weight: 500; color: #f1f5f9; font-size: 0.9rem;">${product.name}</div>
                                <div style="font-size: 0.8rem; color: #94a3b8;">${categoryMapping[product.category] || product.category} • ${product.brand || 'Belirtilmemiş'} • ${product.source}</div>
                            </div>`;
                    });
                    
                    html += '</div>';
                    resultsContainer.innerHTML = html;
                } else {
                    resultsContainer.innerHTML = '<div style="padding: 0.5rem; color: #94a3b8; font-size: 0.9rem;">Ürün bulunamadı</div>';
                }
            } catch (error) {
                console.error('Product search error:', error);
                resultsContainer.innerHTML = '<div style="padding: 0.5rem; color: #ef4444; font-size: 0.9rem;">Arama hatası</div>';
            }
        }

        // Category mapping from site_category to display category
        const categoryMapping = {
            'itopya_ram': 'RAM',
            'incehesap_ram': 'RAM',
            'sinerji_ram': 'RAM',
            'itopya_islemci': 'İşlemci',
            'incehesap_islemci': 'İşlemci',
            'sinerji_islemci': 'İşlemci',
            'itopya_ekran-karti': 'Ekran Kartı',
            'incehesap_ekran-karti': 'Ekran Kartı',
            'sinerji_ekran-karti': 'Ekran Kartı',
            'itopya_anakart': 'Anakart',
            'incehesap_anakart': 'Anakart',
            'sinerji_anakart': 'Anakart',
            'itopya_ssd': 'SSD',
            'incehesap_ssd': 'SSD',
            'sinerji_ssd': 'SSD',
            'itopya_guc-kaynagi': 'Güç Kaynağı',
            'incehesap_guc-kaynagi': 'Güç Kaynağı',
            'sinerji_guc-kaynagi': 'Güç Kaynağı',
            'itopya_bilgisayar-kasasi': 'Bilgisayar Kasası',
            'incehesap_bilgisayar-kasasi': 'Bilgisayar Kasası',
            'sinerji_bilgisayar-kasasi': 'Bilgisayar Kasası'
        };

        // Select product from search results
        function selectProduct(productId, name, category, brand) {
            document.getElementById('specProductName').value = name;
            
            // Map site_category to display category
            const displayCategory = categoryMapping[category] || category;
            document.getElementById('specCategory').value = displayCategory;
            
            document.getElementById('specBrand').value = brand;
            document.getElementById('productSearchResults').innerHTML = '';
            document.getElementById('productSearch').value = name;
            
            loadSpecificationTemplate();
        }

        // Save specification
        async function saveSpecification() {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            const token = localStorage.getItem('adminToken');
            
            const productName = document.getElementById('specProductName').value.trim();
            const category = document.getElementById('specCategory').value;
            const brand = document.getElementById('specBrand').value.trim();
            
            if (!productName || !category) {
                showAlert('error', 'Ürün adı ve kategori gerekli!');
                return;
            }
            
            // Collect specifications
            const specifications = {};
            const category_fields = specificationTemplates[category] || [];
            
            category_fields.forEach(field => {
                const element = document.getElementById(`spec_${field.key}`);
                if (element) {
                    let value;
                    
                    if (field.type === 'boolean') {
                        value = element.checked;
                    } else {
                        value = element.value.trim();
                        if (value === '') return; // Skip empty values
                        
                        if (field.type === 'number') {
                            value = parseFloat(value);
                        }
                    }
                    
                    specifications[field.key] = value;
                }
            });
            
            if (Object.keys(specifications).length === 0) {
                showAlert('error', 'En az bir teknik özellik girmelisiniz!');
                return;
            }
            
            // Check if we're editing (modal has data-edit-id attribute)
            const modal = document.getElementById('specificationModal');
            const editId = modal.getAttribute('data-edit-id');
            const isEditing = editId && editId !== '';
            
            try {
                const url = isEditing 
                    ? `${baseURL}/api/specifications/${editId}`
                    : `${baseURL}/api/specifications`;
                    
                const method = isEditing ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        productName,
                        category,
                        brand: brand || undefined,
                        specifications,
                        productId: currentProductIdForSpec // Include the product ID if available
                    })
                });
                
                if (!response.ok) {
                    console.error('HTTP Error:', response.status, response.statusText);
                    showAlert('error', `HTTP Hatası: ${response.status} ${response.statusText}`);
                    return;
                }
                
                const data = await response.json();
                
                if (data.success) {
                    const message = isEditing 
                        ? 'Teknik özellik başarıyla güncellendi!' 
                        : 'Teknik özellik başarıyla kaydedildi!';
                    showAlert('success', message);
                    closeSpecificationModal();
                    loadSpecificationsList(); // Listeyi yenile
                } else {
                    const action = isEditing ? 'Güncelleme' : 'Kaydetme';
                    showAlert('error', `${action} hatası: ` + (data.error || 'Bilinmeyen hata'));
                }
            } catch (error) {
                console.error('Save specification error:', error);
                showAlert('error', 'Kaydetme hatası: ' + error.message);
            }
        }

        // Load specifications list
        async function loadSpecificationsList() {
            try {
                const category = document.getElementById('filterCategory').value;
                const search = document.getElementById('filterSearch').value.trim();
                
                let url = `${baseURL}/api/specifications?limit=50`;
                if (category) url += `&category=${encodeURIComponent(category)}`;
                if (search) url += `&search=${encodeURIComponent(search)}`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    displaySpecificationsList(data.data);
                } else {
                    document.getElementById('specificationsList').innerHTML = '<div style="padding: 1rem; color: #ef4444;">Veri yükleme hatası</div>';
                }
            } catch (error) {
                console.error('Load specifications error:', error);
                document.getElementById('specificationsList').innerHTML = '<div style="padding: 1rem; color: #ef4444;">Bağlantı hatası</div>';
            }
        }

        // Display specifications list
        function displaySpecificationsList(specifications) {
            const container = document.getElementById('specificationsList');
            
            if (specifications.length === 0) {
                container.innerHTML = '<div style="padding: 2rem; text-align: center; color: #94a3b8;">Henüz teknik özellik eklenmemiş</div>';
                return;
            }
            
            let html = '';
            specifications.forEach(spec => {
                const specsCount = Object.keys(spec.formattedSpecs || {}).length;
                const matchedCount = spec.matchedProducts ? spec.matchedProducts.length : 0;
                
                html += `
                    <div style="background: #0f172a; border: 1px solid #334155; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                            <div>
                                <h4 style="color: #f1f5f9; margin: 0; font-size: 1rem;">${spec.productName}</h4>
                                <div style="color: #94a3b8; font-size: 0.9rem; margin-top: 0.25rem;">
                                    ${spec.category} ${spec.brand ? '• ' + spec.brand : ''} • ${specsCount} özellik • ${matchedCount} eşleşme
                                </div>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button onclick="openManualMatching('${spec._id}')" style="padding: 0.25rem 0.5rem; background: #10b981; color: white; border: none; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-link"></i> Manuel Eşleştir
                                </button>
                                <button onclick="editSpecification('${spec._id}')" style="padding: 0.25rem 0.5rem; background: #3b82f6; color: white; border: none; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-edit"></i> Düzenle
                                </button>
                                <button onclick="deleteSpecification('${spec._id}')" style="padding: 0.25rem 0.5rem; background: #ef4444; color: white; border: none; border-radius: 4px; font-size: 0.8rem; cursor: pointer;">
                                    <i class="fas fa-trash"></i> Sil
                                </button>
                            </div>
                        </div>
                        
                        ${Object.keys(spec.formattedSpecs || {}).length > 0 ? `
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem; font-size: 0.85rem; color: #e2e8f0;">
                                ${Object.entries(spec.formattedSpecs).map(([key, value]) => 
                                    `<div><strong>${key}:</strong> ${value}</div>`
                                ).join('')}
                            </div>
                        ` : ''}
                    </div>`;
            });
            
            container.innerHTML = html;
        }

        // Filter specifications
        function filterSpecifications() {
            loadSpecificationsList();
        }

        // Toggle between search mode and manual mode
        function toggleSearchMode() {
            const searchContainer = document.getElementById('searchContainer');
            const manualContainer = document.getElementById('manualContainer');
            const searchModeBtn = document.getElementById('searchModeBtn');
            
            if (searchContainer.style.display === 'none') {
                // Switch to search mode
                searchContainer.style.display = 'block';
                manualContainer.style.display = 'none';
                searchModeBtn.innerHTML = '<i class="fas fa-toggle-on"></i> Arama Modu';
                searchModeBtn.style.background = '#10b981';
            } else {
                // Switch to manual mode
                searchContainer.style.display = 'none';
                manualContainer.style.display = 'block';
                searchModeBtn.innerHTML = '<i class="fas fa-toggle-off"></i> Manuel Mod';
                searchModeBtn.style.background = '#64748b';
                
                // Clear search results
                document.getElementById('productSearchResults').innerHTML = '';
                document.getElementById('productSearch').value = '';
            }
        }

        // Clear specification form
        function clearSpecificationForm() {
            document.getElementById('specProductName').value = '';
            document.getElementById('specCategory').value = '';
            document.getElementById('specBrand').value = '';
            document.getElementById('productSearch').value = '';
            document.getElementById('productSearchResults').innerHTML = '';
            document.getElementById('specificationFields').innerHTML = '';
            
            // Clear edit mode
            document.getElementById('specificationModal').removeAttribute('data-edit-id');
            
            // Clear current product ID
            currentProductIdForSpec = null;
            
            // Reset to manual mode
            document.getElementById('searchContainer').style.display = 'none';
            document.getElementById('manualContainer').style.display = 'block';
            document.getElementById('searchModeBtn').innerHTML = '<i class="fas fa-toggle-off"></i> Manuel Mod';
            document.getElementById('searchModeBtn').style.background = '#64748b';
        }

        // Edit specification
        async function editSpecification(id) {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            try {
                // Fetch the specification data
                const response = await fetch(`${baseURL}/api/specifications/${id}`);
                const result = await response.json();
                
                if (!result.success) {
                    showAlert('error', 'Özellik bulunamadı: ' + result.error);
                    return;
                }
                
                const spec = result.data;
                
                // Fill the form with existing data
                document.getElementById('specProductName').value = spec.productName;
                document.getElementById('specCategory').value = spec.category;
                document.getElementById('specBrand').value = spec.brand || '';
                
                // Ensure templates are loaded first
                if (Object.keys(specificationTemplates).length === 0) {
                    console.log('Templates not loaded, loading now...');
                    await loadSpecificationTemplates();
                }
                
                // Load category template and populate fields
                console.log('Category before loading template:', spec.category);
                console.log('Available templates:', Object.keys(specificationTemplates));
                loadSpecificationTemplate();
                
                // Check if template loaded
                setTimeout(() => {
                    const fieldsContainer = document.getElementById('specificationFields');
                    console.log('Fields container after template load:', fieldsContainer.innerHTML.length > 0 ? 'Has content' : 'Empty');
                }, 100);
                
                // Wait for the DOM to update, then fill the fields
                setTimeout(() => {
                    console.log('Filling fields with data:', spec.specifications);
                    
                    // Fill specification fields
                    const specifications = spec.specifications || {};
                    Object.entries(specifications).forEach(([key, value]) => {
                        const field = document.getElementById(`spec_${key}`);
                        console.log(`Field spec_${key}:`, field, 'Value:', value);
                        
                        if (field) {
                            if (field.tagName === 'SELECT') {
                                // For select fields (including boolean)
                                field.value = value.toString();
                            } else if (field.type === 'checkbox') {
                                field.checked = value === true;
                            } else {
                                // For text and number inputs
                                field.value = value;
                            }
                            console.log(`Set field ${key} to:`, field.value);
                        } else {
                            console.warn(`Field spec_${key} not found in DOM`);
                        }
                    });
                }, 300);
                
                // Store the ID for updating
                document.getElementById('specificationModal').setAttribute('data-edit-id', id);
                
                // Close the specifications list modal first
                document.getElementById('specificationsListModal').style.display = 'none';
                
                // Show the edit modal
                document.getElementById('specificationModal').style.display = 'flex';
                
                showAlert('success', 'Düzenleme modunda açıldı');
                
            } catch (error) {
                console.error('Edit specification error:', error);
                showAlert('error', 'Düzenleme hatası: ' + error.message);
            }
        }

        // Delete specification
        async function deleteSpecification(id) {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            if (!confirm('Bu teknik özelliği silmek istediğinizden emin misiniz?')) {
                return;
            }
            
            const token = localStorage.getItem('adminToken');
            
            try {
                const response = await fetch(`${baseURL}/api/specifications/${id}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showAlert('success', 'Teknik özellik silindi!');
                    loadSpecificationsList();
                } else {
                    showAlert('error', 'Silme hatası: ' + (data.error || 'Bilinmeyen hata'));
                }
            } catch (error) {
                console.error('Delete specification error:', error);
                showAlert('error', 'Silme hatası: ' + error.message);
            }
        }

        // matchProducts fonksiyonu kaldırıldı - Manuel eşleştirme sistemi kullanılıyor

        // View unmatched products
        async function viewUnmatchedProducts() {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            try {
                const response = await fetch(`${baseURL}/api/specifications/unmatched?limit=50`);
                const data = await response.json();
                
                if (data.success) {
                    displayUnmatchedProducts(data.data, data.pagination);
                } else {
                    showAlert('error', 'Eşleşmeyen ürünler yüklenemedi: ' + (data.error || 'Bilinmeyen hata'));
                }
            } catch (error) {
                console.error('Unmatched products error:', error);
                showAlert('error', 'Eşleşmeyen ürünler yüklenemedi: ' + error.message);
            }
        }

        // Display unmatched products
        function displayUnmatchedProducts(products, pagination) {
            let html = `
                <div class="modal" id="unmatchedProductsModal" style="display: flex;">
                    <div class="modal-content" style="max-width: 1000px; max-height: 80vh; overflow-y: auto;">
                        <div class="modal-header">
                            <h2>
                                <i class="fas fa-exclamation-triangle"></i> Eksik Özellikler
                            </h2>
                            <button class="close" onclick="closeUnmatchedProductsModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <!-- Search and Filters -->
                            <div style="margin-bottom: 1.5rem;">
                                <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                    <input type="text" id="unmatchedSearchInput" placeholder="Ürün adı ile ara..." 
                                           onkeyup="filterUnmatchedProducts()" 
                                           style="flex: 1; min-width: 200px; padding: 0.75rem; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: #e2e8f0; font-size: 0.9rem;"
                                           class="search-input">
                                    <button class="btn btn-primary" onclick="loadUnmatchedProducts()" style="padding: 0.75rem 1rem;">
                                        <i class="fas fa-sync"></i> Yenile
                                    </button>
                                </div>
                                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                    <select id="unmatchedCategoryFilter" onchange="filterUnmatchedProducts()" style="padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0;">
                                        <option value="">Tüm Kategoriler</option>
                                        <option value="İşlemci">İşlemci</option>
                                        <option value="Ekran Kartı">Ekran Kartı</option>
                                        <option value="Anakart">Anakart</option>
                                        <option value="RAM">RAM</option>
                                        <option value="SSD">SSD</option>
                                        <option value="Güç Kaynağı">Güç Kaynağı</option>
                                        <option value="Bilgisayar Kasası">Bilgisayar Kasası</option>
                                    </select>
                                    <select id="unmatchedSortBy" onchange="filterUnmatchedProducts()" style="padding: 0.5rem; background: #0f172a; border: 1px solid #334155; border-radius: 4px; color: #e2e8f0;">
                                        <option value="currentPrice_desc">Fiyat: Yüksek → Düşük</option>
                                        <option value="currentPrice_asc">Fiyat: Düşük → Yüksek</option>
                                        <option value="priorityScore_desc">Öncelik: Yüksek → Düşük</option>
                                        <option value="scrapedAt_desc">Tarih: Yeni → Eski</option>
                                        <option value="scrapedAt_asc">Tarih: Eski → Yeni</option>
                                        <option value="name_asc">İsim: A → Z</option>
                                        <option value="name_desc">İsim: Z → A</option>
                                    </select>
                                    <button class="btn btn-success" onclick="createSpecificationFromProducts()">
                                        <i class="fas fa-plus"></i> Seçilenler için Özellik Ekle
                                    </button>
                                </div>
                            </div>
                            <div id="unmatchedProductsList">`;
            
            if (products.length === 0) {
                html += '<p style="text-align: center; color: #94a3b8;">Eşleşmeyen ürün bulunamadı.</p>';
            } else {
                html += `
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">`;
                
                products.forEach(product => {
                    html += `
                        <div class="product-card" style="background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 1rem; cursor: pointer;" 
                             onclick="toggleProductSelection('${product._id}', this)">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                <input type="checkbox" id="product_${product._id}" style="margin: 0;">
                                <div class="product-image-container" style="width: 60px; height: 60px; border-radius: 4px; overflow: hidden; background: #334155; display: flex; align-items: center; justify-content: center; position: relative;">
                                    ${product.imageUrl && product.imageUrl !== '' && product.imageUrl !== 'null' ? 
                                        `<img src="${product.imageUrl}" alt="${product.name}" 
                                             style="width: 100%; height: 100%; object-fit: cover;" 
                                             onload="this.style.opacity='1';" 
                                             onerror="this.parentElement.innerHTML='<i class=\\"fas fa-image\\" style=\\"color: #64748b; font-size: 1.2rem;\\"></i>';"
                                             style="opacity: 0; transition: opacity 0.3s;">` : 
                                        `<i class="fas fa-image" style="color: #64748b; font-size: 1.2rem;"></i>`
                                    }
                                </div>
                            </div>
                            <h4 style="color: #f1f5f9; margin: 0.5rem 0; font-size: 0.9rem; line-height: 1.3;">${product.name}</h4>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                <span style="color: #10b981; font-weight: bold; font-size: 1.1rem;">₺${product.currentPrice?.toLocaleString('tr-TR') || 'N/A'}</span>
                                <span style="color: #64748b; font-size: 0.8rem;">${product.displayCategory}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: #94a3b8;">
                                <span><i class="fas fa-store"></i> ${product.source}</span>
                                <span><i class="fas fa-star"></i> ${product.priorityScore || 0}</span>
                            </div>
                            <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); createSpecificationForProduct('${product._id}', '${product.name}', '${product.displayCategory}', '${product.brand || ''}')" style="width: 100%; margin-top: 0.5rem; font-size: 0.8rem;">
                                <i class="fas fa-plus"></i> Özellik Ekle
                            </button>
                        </div>`;
                });
                
                html += '</div>';
            }
            
            html += `
                            </div>
                            <div style="margin-top: 1rem; text-align: center; color: #94a3b8;">
                                Toplam ${pagination.totalItems} ürün • Sayfa ${pagination.currentPage} / ${pagination.totalPages}
                            </div>
                        </div>
                    </div>
                </div>`;
            
            // Remove existing modal if present
            const existingModal = document.getElementById('unmatchedProductsModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', html);
        }

        // Close unmatched products modal
        function closeUnmatchedProductsModal() {
            const modal = document.getElementById('unmatchedProductsModal');
            if (modal) {
                modal.remove();
            }
        }

        // Toggle product selection
        function toggleProductSelection(productId, cardElement) {
            const checkbox = document.getElementById(`product_${productId}`);
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                cardElement.style.borderColor = '#10b981';
                cardElement.style.backgroundColor = '#065f46';
            } else {
                cardElement.style.borderColor = '#334155';
                cardElement.style.backgroundColor = '#1e293b';
            }
        }

        // Global variable to store the current product ID being processed
        let currentProductIdForSpec = null;

        // Create specification for single product
        function createSpecificationForProduct(productId, productName, category, brand) {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            
            // Store the product ID for later use in saveSpecification
            currentProductIdForSpec = productId;
            
            // Fill specification form with product details
            document.getElementById('specProductName').value = productName;
            document.getElementById('specCategory').value = category;
            document.getElementById('specBrand').value = brand || '';
            
            // Load template for category
            loadSpecificationTemplate();
            
            // Show specification modal
            showSpecificationManager();
            
            // Close unmatched products modal
            closeUnmatchedProductsModal();
            
            showAlert('info', `${productName} için özellik formu hazırlandı. Lütfen teknik özellikleri doldurun.`);
        }

        // View coverage statistics
        async function viewCoverageStats() {
            if (!requireAuthentication()) {
                initializeAdminInterface();
                return;
            }
            try {
                const response = await fetch(`${baseURL}/api/specifications/coverage`);
                const data = await response.json();
                
                if (data.success) {
                    displayCoverageStats(data.data);
                } else {
                    showAlert('error', 'Kapsam istatistikleri yüklenemedi: ' + (data.error || 'Bilinmeyen hata'));
                }
            } catch (error) {
                console.error('Coverage stats error:', error);
                showAlert('error', 'Kapsam istatistikleri yüklenemedi: ' + error.message);
            }
        }

        // Display coverage statistics
        function displayCoverageStats(stats) {
            let html = `
                <div class="modal" id="coverageStatsModal" style="display: flex;">
                    <div class="modal-content" style="max-width: 800px;">
                        <div class="modal-header">
                            <h2>
                                <i class="fas fa-chart-bar"></i> Kapsam İstatistikleri
                            </h2>
                            <button class="close" onclick="closeCoverageStatsModal()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="modal-body">
                            <!-- Genel İstatistikler -->
                            <div class="card" style="margin-bottom: 1.5rem;">
                                <h3 style="color: #f1f5f9; margin-bottom: 1rem;">Genel Durum</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                    <div style="text-align: center; padding: 1rem; background: #0f172a; border-radius: 8px;">
                                        <div style="font-size: 2rem; color: #3b82f6; margin-bottom: 0.5rem;">${stats.overall.totalProducts.toLocaleString('tr-TR')}</div>
                                        <div style="color: #94a3b8;">Toplam Ürün</div>
                                    </div>
                                    <div style="text-align: center; padding: 1rem; background: #0f172a; border-radius: 8px;">
                                        <div style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;">${stats.overall.specifiedProducts.toLocaleString('tr-TR')}</div>
                                        <div style="color: #94a3b8;">Özellik Mevcut</div>
                                    </div>
                                    <div style="text-align: center; padding: 1rem; background: #0f172a; border-radius: 8px;">
                                        <div style="font-size: 2rem; color: #ef4444; margin-bottom: 0.5rem;">${stats.overall.unspecifiedProducts.toLocaleString('tr-TR')}</div>
                                        <div style="color: #94a3b8;">Özellik Eksik</div>
                                    </div>
                                    <div style="text-align: center; padding: 1rem; background: #0f172a; border-radius: 8px;">
                                        <div style="font-size: 2rem; color: #f59e0b; margin-bottom: 0.5rem;">%${stats.overall.coveragePercentage}</div>
                                        <div style="color: #94a3b8;">Kapsam Oranı</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Kategori Bazlı İstatistikler -->
                            <div class="card">
                                <h3 style="color: #f1f5f9; margin-bottom: 1rem;">Kategorilere Göre Durum</h3>
                                <div style="overflow-x: auto;">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="background: #0f172a; color: #f1f5f9;">
                                                <th style="padding: 0.75rem; text-align: left; border: 1px solid #334155;">Kategori</th>
                                                <th style="padding: 0.75rem; text-align: center; border: 1px solid #334155;">Toplam Ürün</th>
                                                <th style="padding: 0.75rem; text-align: center; border: 1px solid #334155;">Özellik Mevcut</th>
                                                <th style="padding: 0.75rem; text-align: center; border: 1px solid #334155;">Özellik Eksik</th>
                                                <th style="padding: 0.75rem; text-align: center; border: 1px solid #334155;">Kapsam %</th>
                                                <th style="padding: 0.75rem; text-align: center; border: 1px solid #334155;">Durum</th>
                                            </tr>
                                        </thead>
                                        <tbody>`;
            
            stats.byCategory.forEach(category => {
                const statusColor = category.coveragePercentage >= 75 ? '#10b981' : category.coveragePercentage >= 50 ? '#f59e0b' : '#ef4444';
                const statusText = category.coveragePercentage >= 75 ? 'İyi' : category.coveragePercentage >= 50 ? 'Orta' : 'Düşük';
                
                html += `
                    <tr style="background: #1e293b; color: #e2e8f0;">
                        <td style="padding: 0.75rem; border: 1px solid #334155; font-weight: 500;">${category.category}</td>
                        <td style="padding: 0.75rem; border: 1px solid #334155; text-align: center;">${category.totalProducts.toLocaleString('tr-TR')}</td>
                        <td style="padding: 0.75rem; border: 1px solid #334155; text-align: center; color: #10b981;">${category.specifiedProducts.toLocaleString('tr-TR')}</td>
                        <td style="padding: 0.75rem; border: 1px solid #334155; text-align: center; color: #ef4444;">${category.unspecifiedProducts.toLocaleString('tr-TR')}</td>
                        <td style="padding: 0.75rem; border: 1px solid #334155; text-align: center; font-weight: bold;">%${category.coveragePercentage}</td>
                        <td style="padding: 0.75rem; border: 1px solid #334155; text-align: center;">
                            <span style="color: ${statusColor}; font-weight: bold;">${statusText}</span>
                        </td>
                    </tr>`;
            });
            
            html += `
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            
            // Remove existing modal if present
            const existingModal = document.getElementById('coverageStatsModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Add modal to page
            document.body.insertAdjacentHTML('beforeend', html);
        }

        // Close coverage stats modal
        function closeCoverageStatsModal() {
            const modal = document.getElementById('coverageStatsModal');
            if (modal) {
                modal.remove();
            }
        }

        // Rematch all specifications with smart matching
        // rematchAllSpecifications fonksiyonu kaldırıldı - Manuel eşleştirme yeterli

        // Filter unmatched products
        async function filterUnmatchedProducts() {
            const category = document.getElementById('unmatchedCategoryFilter')?.value;
            const sortOption = document.getElementById('unmatchedSortBy')?.value || 'currentPrice_desc';
            const searchQuery = document.getElementById('unmatchedSearchInput')?.value?.trim();
            
            // Sort option'ı ayrıştır (field_direction)
            const [sortBy, sortOrder] = sortOption.split('_');
            
            let url = `${baseURL}/api/specifications/unmatched?limit=50&sortBy=${sortBy}&sortOrder=${sortOrder}`;
            if (category) {
                url += `&category=${encodeURIComponent(category)}`;
            }
            if (searchQuery) {
                url += `&search=${encodeURIComponent(searchQuery)}`;
            }
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.success) {
                    // Update only the products list part
                    const productsContainer = document.getElementById('unmatchedProductsList');
                    if (productsContainer) {
                        let html = '';
                        
                        if (data.data.length === 0) {
                            html = '<p style="text-align: center; color: #94a3b8;">Eşleşmeyen ürün bulunamadı.</p>';
                        } else {
                            html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">';
                            
                            data.data.forEach(product => {
                                html += `
                                    <div class="product-card" style="background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 1rem; cursor: pointer;" 
                                         onclick="toggleProductSelection('${product._id}', this)">
                                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                            <input type="checkbox" id="product_${product._id}" style="margin: 0;">
                                            <div class="product-image-container" style="width: 60px; height: 60px; border-radius: 4px; overflow: hidden; background: #334155; display: flex; align-items: center; justify-content: center; position: relative;">
                                                ${product.imageUrl && product.imageUrl !== '' && product.imageUrl !== 'null' ? 
                                                    `<img src="${product.imageUrl}" alt="${product.name}" 
                                                         style="width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.3s;" 
                                                         onload="this.style.opacity='1';" 
                                                         onerror="this.parentElement.innerHTML='<i class=\\"fas fa-image\\" style=\\"color: #64748b; font-size: 1.2rem;\\"></i>';">` : 
                                                    `<i class="fas fa-image" style="color: #64748b; font-size: 1.2rem;"></i>`
                                                }
                                            </div>
                                        </div>
                                        <h4 style="color: #f1f5f9; margin: 0.5rem 0; font-size: 0.9rem; line-height: 1.3;">${product.name}</h4>
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="color: #10b981; font-weight: bold; font-size: 1.1rem;">₺${product.currentPrice?.toLocaleString('tr-TR') || 'N/A'}</span>
                                            <span style="color: #64748b; font-size: 0.8rem;">${product.displayCategory}</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: #94a3b8;">
                                            <span><i class="fas fa-store"></i> ${product.source}</span>
                                            <span><i class="fas fa-star"></i> ${product.priorityScore || 0}</span>
                                        </div>
                                        <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); createSpecificationForProduct('${product._id}', '${product.name}', '${product.displayCategory}', '${product.brand || ''}')" style="width: 100%; margin-top: 0.5rem; font-size: 0.8rem;">
                                            <i class="fas fa-plus"></i> Özellik Ekle
                                        </button>
                                    </div>`;
                            });
                            
                            html += '</div>';
                        }
                        
                        productsContainer.innerHTML = html;
                    }
                } else {
                    showAlert('error', 'Filtreleme hatası: ' + (data.error || 'Bilinmeyen hata'));
                }
            } catch (error) {
                console.error('Filter unmatched products error:', error);
                showAlert('error', 'Filtreleme hatası: ' + error.message);
            }
        }

        // Create specifications from selected products (bulk operation)
        function createSpecificationFromProducts() {
            const checkboxes = document.querySelectorAll('#unmatchedProductsModal input[type="checkbox"]:checked');
            
            if (checkboxes.length === 0) {
                showAlert('warning', 'Lütfen en az bir ürün seçin.');
                return;
            }
            
            if (checkboxes.length > 10) {
                showAlert('warning', 'Bir seferde maksimum 10 ürün için özellik oluşturabilirsiniz.');
                return;
            }
            
            // Get selected products info
            const selectedProducts = [];
            checkboxes.forEach(checkbox => {
                const productId = checkbox.id.replace('product_', '');
                const productCard = checkbox.closest('.product-card');
                const productName = productCard.querySelector('h4').textContent;
                const categoryElement = productCard.querySelector('.product-card > div:nth-child(3) > span:nth-child(2)');
                const category = categoryElement ? categoryElement.textContent : '';
                
                selectedProducts.push({
                    id: productId,
                    name: productName,
                    category: category
                });
            });
            
            showAlert('info', `${selectedProducts.length} ürün seçildi. Toplu özellik ekleme özelliği yakında eklenecek.`);
            
            // For now, just show the first product's specification form
            if (selectedProducts.length > 0) {
                const firstProduct = selectedProducts[0];
                createSpecificationForProduct(firstProduct.id, firstProduct.name, firstProduct.category, '');
            }
        }

        // Manual matching functions
        let currentSpecificationId = null;

        function openManualMatching(specificationId) {
            currentSpecificationId = specificationId;
            document.getElementById('manualMatchingModal').style.display = 'block';
            loadSpecificationInfo(specificationId);
            loadCurrentMatches(specificationId);
            searchPotentialMatches('');
        }

        function closeManualMatchingModal() {
            document.getElementById('manualMatchingModal').style.display = 'none';
            currentSpecificationId = null;
        }

        async function loadSpecificationInfo(specificationId) {
            try {
                const response = await safeApiCall(`${baseURL}/api/specifications/${specificationId}`);
                
                let specData = response.data;
                if (response.success && response.data && response.data.success && response.data.data) {
                    specData = response.data.data;
                }
                
                if (specData) {
                    // Populate basic info
                    document.getElementById('specProductName').textContent = specData.productName || 'Bilinmeyen Ürün';
                    document.getElementById('specProductCategory').textContent = specData.category || 'Bilinmeyen Kategori';
                    document.getElementById('debugSpecId').textContent = specificationId;
                    document.getElementById('debugLastUpdate').textContent = specData.verifiedAt ? 
                        new Date(specData.verifiedAt).toLocaleDateString('tr-TR') : 'Henüz güncellenmemiş';
                    
                    // Extract key features for matching algorithm display
                    const productName = specData.productName || '';
                    const keyFeatures = extractKeyFeaturesFromName(productName);
                    
                    // Populate features grid
                    const featuresGrid = document.getElementById('featuresGrid');
                    featuresGrid.innerHTML = '';
                    
                    if (keyFeatures.modelNumber) {
                        featuresGrid.innerHTML += `
                            <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); border-radius: 4px; padding: 0.5rem;">
                                <div style="font-size: 0.7rem; color: #94a3b8; margin-bottom: 0.25rem;">MODEL NUMARASI</div>
                                <div style="font-weight: bold; color: #10b981; font-size: 0.85rem;">${keyFeatures.modelNumber}</div>
                            </div>
                        `;
                    }
                    
                    if (keyFeatures.variant) {
                        featuresGrid.innerHTML += `
                            <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 4px; padding: 0.5rem;">
                                <div style="font-size: 0.7rem; color: #94a3b8; margin-bottom: 0.25rem;">VARİANT</div>
                                <div style="font-weight: bold; color: #f59e0b; font-size: 0.85rem;">${keyFeatures.variant.toUpperCase()}</div>
                            </div>
                        `;
                    }
                    
                    if (keyFeatures.brand) {
                        featuresGrid.innerHTML += `
                            <div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 4px; padding: 0.5rem;">
                                <div style="font-size: 0.7rem; color: #94a3b8; margin-bottom: 0.25rem;">MARKA</div>
                                <div style="font-weight: bold; color: #3b82f6; font-size: 0.85rem;">${keyFeatures.brand.toUpperCase()}</div>
                            </div>
                        `;
                    }
                    
                    if (keyFeatures.capacity) {
                        featuresGrid.innerHTML += `
                            <div style="background: rgba(168, 85, 247, 0.1); border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 4px; padding: 0.5rem;">
                                <div style="font-size: 0.7rem; color: #94a3b8; margin-bottom: 0.25rem;">KAPASİTE</div>
                                <div style="font-weight: bold; color: #8b5cf6; font-size: 0.85rem;">${keyFeatures.capacity}</div>
                            </div>
                        `;
                    }
                    
                    // Calculate and display performance stats
                    const totalMatches = specData.matchedProducts ? specData.matchedProducts.length : 0;
                    document.getElementById('totalMatches').textContent = totalMatches;
                    
                    if (totalMatches > 0 && specData.matchedProducts) {
                        // Ortalama güven hesapla - hem similarity hem confidence'ı kontrol et
                        const confidenceSum = specData.matchedProducts.reduce((sum, match) => {
                            if (!match) return sum; // Skip null/undefined matches
                            const confidence = match.similarity || match.confidence || 0;
                            return sum + confidence;
                        }, 0);
                        const avgConfidence = confidenceSum / totalMatches;
                        document.getElementById('avgConfidence').textContent = Math.round(avgConfidence * 100) + '%';
                        
                        // Son eşleşme tarihini bul - matchedAt field'ını kullan
                        const matchesWithDates = specData.matchedProducts.filter(match => 
                            match && (match.matchedAt || match.addedAt || match.createdAt)
                        );
                        
                        if (matchesWithDates.length > 0) {
                            // En son tarihi bul
                            const lastMatch = matchesWithDates.reduce((latest, current) => {
                                const currentDate = new Date(current.matchedAt || current.addedAt || current.createdAt);
                                const latestDate = new Date(latest.matchedAt || latest.addedAt || latest.createdAt);
                                return currentDate > latestDate ? current : latest;
                            });
                            
                            const lastDate = lastMatch.matchedAt || lastMatch.addedAt || lastMatch.createdAt;
                            document.getElementById('lastMatched').textContent = new Date(lastDate).toLocaleDateString('tr-TR');
                        } else {
                            // Hiç tarih yoksa specification'ın lastMatchedAt'ini kullan
                            if (specData.lastMatchedAt) {
                                document.getElementById('lastMatched').textContent = new Date(specData.lastMatchedAt).toLocaleDateString('tr-TR');
                            } else {
                                document.getElementById('lastMatched').textContent = 'Bilinmiyor';
                            }
                        }
                    } else {
                        document.getElementById('avgConfidence').textContent = '0%';
                        document.getElementById('lastMatched').textContent = '-';
                    }
                }
            } catch (error) {
                console.error('Load specification info error:', error);
                document.getElementById('specProductName').textContent = 'Yükleme Hatası';
                document.getElementById('specProductCategory').textContent = error.message;
            }
        }

        // Helper function to extract key features from product name
        function extractKeyFeaturesFromName(productName) {
            const name = productName.toLowerCase().trim();
            const features = {};
            
            // Brand extraction
            const brandPatterns = {
                'nvidia': /nvidia|rtx|gtx|geforce/,
                'amd': /amd|radeon|rx|ryzen/,
                'intel': /intel|i3|i5|i7|i9/,
                'corsair': /corsair/,
                'gskill': /g\.?skill/,
                'kingston': /kingston/,
                'samsung': /samsung/,
                'asus': /asus/,
                'msi': /msi/,
                'gigabyte': /gigabyte/
            };
            
            for (const [brand, pattern] of Object.entries(brandPatterns)) {
                if (pattern.test(name)) {
                    features.brand = brand;
                    break;
                }
            }
            
            // Model number extraction (more comprehensive)
            const modelPatterns = [
                /rtx\s?(\d{4})\s?(ti|super)?/,
                /rx\s?(\d{4})\s?(xt|pro)?/,
                /i(\d)-(\d{4,5})[a-z]*/,
                /ryzen\s?(\d)\s?(\d{4})[a-z]*/,
                /(\d+gb)\s?(ddr[45])/,
                /(\d+gb)\s?(m\.2|ssd|nvme)/
            ];
            
            for (const pattern of modelPatterns) {
                const match = name.match(pattern);
                if (match) {
                    features.modelNumber = match[0].replace(/\s+/g, '');
                    break;
                }
            }
            
            // Variant extraction
            const variantPatterns = ['ti', 'super', 'xt', 'pro', 'gaming', 'oc'];
            for (const variant of variantPatterns) {
                if (name.includes(variant)) {
                    features.variant = variant;
                    break;
                }
            }
            
            // Capacity extraction
            const capacityMatch = name.match(/(\d+)\s?(gb|tb|mb)/);
            if (capacityMatch) {
                features.capacity = capacityMatch[0];
            }
            
            return features;
        }

        async function loadCurrentMatches(specificationId) {
            const currentMatchesDiv = document.getElementById('currentMatches');
            currentMatchesDiv.innerHTML = '<div class="loading">Mevcut eşleşmeler yükleniyor...</div>';

            try {
                const response = await safeApiCall(`${baseURL}/api/specifications/${specificationId}`);
                
                // Handle double-wrapped response
                let specData = response.data;
                if (response.success && response.data && response.data.success && response.data.data) {
                    specData = response.data.data;
                }
                
                if (specData && specData.matchedProducts) {
                    document.getElementById('currentMatchCount').textContent = specData.matchedProducts.length;
                    
                    if (specData.matchedProducts.length === 0) {
                        currentMatchesDiv.innerHTML = '<div class="no-matches">Henüz eşleşme yok</div>';
                    } else {
                        const matchesHtml = specData.matchedProducts.map(match => {
                            // matchedProducts has structure: { productId: {...}, similarity: number, source: string }
                            const product = match.productId || match; // Handle both populated and non-populated cases
                            const productName = product.name || product.productName || 'Bilinmeyen Ürün';
                            const productBrand = product.brand || 'Bilinmeyen Marka';
                            const productSource = (match && match.source) || product.source || 'Bilinmeyen Kaynak';
                            const productPrice = product.currentPrice || 0;
                            const similarity = (match && (match.similarity || match.confidence)) || 0;
                            const productId = product._id || product.productId || (match && match.productId);
                            
                            return `
                                <div class="match-item match-item-selectable" onclick="toggleCurrentSelection('${productId}', this)">
                                    <div style="display: flex; align-items: center;">
                                        <input type="checkbox" class="match-checkbox" data-product-id="${productId}" onclick="event.stopPropagation(); toggleCurrentSelection('${productId}', this.closest('.match-item'));">
                                        <div class="match-info" style="flex: 1;">
                                            <div class="match-name">${highlightMatchingTerms(productName, specData.productName)}</div>
                                            <div class="match-details">
                                                ${productBrand} • ${productSource} • ₺${productPrice.toLocaleString()}
                                            </div>
                                            <div class="confidence-score confidence-${getConfidenceLevel(similarity)}">
                                                Güven: ${Math.round(similarity * 100)}% ${getMatchingIcon(similarity)}
                                            </div>
                                        </div>
                                        <button class="remove-match-btn" onclick="event.stopPropagation(); removeMatch('${specificationId}', '${productId}')" style="margin-left: 1rem;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        currentMatchesDiv.innerHTML = matchesHtml;
                    }
                    
                    updateCurrentSelectionCount();
                } else {
                    console.error('Load current matches error:', response);
                    currentMatchesDiv.innerHTML = '<div class="error">Eşleşmeler yüklenirken hata oluştu: ' + (response.error || 'Veri formatı hatası') + '</div>';
                }
            } catch (error) {
                console.error('Load current matches error:', error);
                currentMatchesDiv.innerHTML = '<div class="error">Eşleşmeler yüklenirken hata oluştu: ' + error.message + '</div>';
            }
        }

        async function searchPotentialMatches(searchTerm = '') {
            const potentialMatchesDiv = document.getElementById('potentialMatches');
            potentialMatchesDiv.innerHTML = '<div class="loading">Potansiyel eşleşmeler aranıyor...</div>';

            try {
                const url = `${baseURL}/api/specifications/${currentSpecificationId}/potential-matches${searchTerm ? `?search=${encodeURIComponent(searchTerm)}` : ''}`;
                const response = await safeApiCall(url);
                
                // Handle double-wrapped response and extract potentialMatches
                let matchData = null;
                if (response.success && response.data) {
                    if (response.data.success && response.data.data) {
                        // Double-wrapped: { success: true, data: { success: true, data: { potentialMatches: [...] } } }
                        matchData = response.data.data.potentialMatches;
                    } else if (response.data.potentialMatches) {
                        // Single-wrapped: { success: true, data: { potentialMatches: [...] } }
                        matchData = response.data.potentialMatches;
                    } else if (Array.isArray(response.data)) {
                        // Direct array: { success: true, data: [...] }
                        matchData = response.data;
                    }
                }
                
                if (matchData && Array.isArray(matchData)) {
                    document.getElementById('potentialMatchCount').textContent = matchData.length;
                    
                    if (matchData.length === 0) {
                        potentialMatchesDiv.innerHTML = '<div class="no-matches">Potansiyel eşleşme bulunamadı</div>';
                    } else {
                        // Get specification data for comparison (if available)
                        let specificationName = '';
                        try {
                            const specResponse = await safeApiCall(`${baseURL}/api/specifications/${currentSpecificationId}`);
                            let specData = specResponse.data;
                            if (specResponse.success && specResponse.data && specResponse.data.success && specResponse.data.data) {
                                specData = specResponse.data.data;
                            }
                            specificationName = specData ? specData.productName : '';
                        } catch (error) {
                            console.log('Could not fetch spec name for highlighting');
                        }
                        
                        const potentialHtml = matchData.map(product => {
                            const productId = product.productId || product._id;
                            const productName = product.productName || product.name;
                            return `
                                <div class="potential-match-item potential-match-item-selectable" onclick="togglePotentialSelection('${productId}', this)">
                                    <div style="display: flex; align-items: center;">
                                        <input type="checkbox" class="match-checkbox" data-product-id="${productId}" onclick="event.stopPropagation(); togglePotentialSelection('${productId}', this.closest('.potential-match-item'));">
                                        <div class="match-info" style="flex: 1;">
                                            <div class="match-name">${highlightMatchingTerms(productName, specificationName)}</div>
                                            <div class="match-details">
                                                ${product.brand} • ${product.source} • ₺${product.currentPrice?.toLocaleString()}
                                            </div>
                                            <div class="confidence-score confidence-${getConfidenceClass(product.similarity)}">
                                                Benzerlik: ${Math.round(product.similarity * 100)}% ${getMatchingIcon(product.similarity)}
                                            </div>
                                        </div>
                                        <button class="add-match-btn" onclick="event.stopPropagation(); addMatch('${currentSpecificationId}', '${productId}')" style="margin-left: 1rem;">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        potentialMatchesDiv.innerHTML = potentialHtml;
                    }
                    
                    updatePotentialSelectionCount();
                } else {
                    console.error('Potential matches API error:', response);
                    if (response.error && response.error.includes('404')) {
                        potentialMatchesDiv.innerHTML = '<div class="error">API endpoint bulunamadı. Lütfen sayfayı yenileyin.</div>';
                    } else if (response.error && (response.error.includes('401') || response.error.includes('403'))) {
                        potentialMatchesDiv.innerHTML = '<div class="error">Yetki hatası. Lütfen tekrar giriş yapın.</div>';
                        showAlert('error', 'Oturum süreniz dolmuş. Lütfen tekrar giriş yapın.');
                    } else {
                        potentialMatchesDiv.innerHTML = '<div class="error">Potansiyel eşleşmeler yüklenirken hata oluştu: ' + (response.error || 'Veri formatı hatası') + '</div>';
                    }
                }
            } catch (error) {
                console.error('Search potential matches error:', error);
                potentialMatchesDiv.innerHTML = '<div class="error">Potansiyel eşleşmeler yüklenirken hata oluştu: ' + error.message + '</div>';
            }
        }

        function getConfidenceClass(similarity) {
            if (similarity >= 0.9) return 'high';
            if (similarity >= 0.7) return 'medium';
            return 'low';
        }

        function getConfidenceLevel(similarity) {
            if (similarity >= 0.9) return 'high';
            if (similarity >= 0.7) return 'medium';
            return 'low';
        }

        function getMatchingIcon(similarity) {
            if (similarity >= 0.9) return '<i class="fas fa-check-circle" style="color: #10b981; margin-left: 0.5rem;"></i>';
            if (similarity >= 0.7) return '<i class="fas fa-exclamation-circle" style="color: #f59e0b; margin-left: 0.5rem;"></i>';
            return '<i class="fas fa-question-circle" style="color: #ef4444; margin-left: 0.5rem;"></i>';
        }

        // Enhanced color highlighting for matching terms
        function highlightMatchingTerms(productName, specificationName) {
            if (!productName || !specificationName) return productName || '';
            
            const product = productName.toLowerCase();
            const spec = specificationName.toLowerCase();
            
            // Extract key terms from both names
            const productTerms = extractKeyTerms(product);
            const specTerms = extractKeyTerms(spec);
            
            let highlighted = productName;
            
            // Find matching terms
            const matchingTerms = productTerms.filter(term => 
                specTerms.some(specTerm => 
                    term.includes(specTerm) || specTerm.includes(term) || 
                    levenshteinDistance(term, specTerm) <= 1
                )
            );
            
            // Find non-matching terms
            const nonMatchingTerms = productTerms.filter(term => 
                !matchingTerms.includes(term)
            );
            
            // Highlight matching terms in green
            matchingTerms.forEach(term => {
                const regex = new RegExp(`\\b${escapeRegex(term)}\\b`, 'gi');
                highlighted = highlighted.replace(regex, `<span style="background: rgba(16, 185, 129, 0.2); color: #10b981; padding: 0.125rem 0.25rem; border-radius: 3px; font-weight: 600;">$&</span>`);
            });
            
            // Highlight non-matching important terms in orange/yellow
            const importantNonMatching = nonMatchingTerms.filter(term => 
                term.length > 2 && 
                /\d/.test(term) && // Contains numbers (likely model numbers)
                !['the', 'and', 'or', 'with', 'for'].includes(term)
            );
            
            importantNonMatching.forEach(term => {
                const regex = new RegExp(`\\b${escapeRegex(term)}\\b`, 'gi');
                highlighted = highlighted.replace(regex, `<span style="background: rgba(245, 158, 11, 0.2); color: #f59e0b; padding: 0.125rem 0.25rem; border-radius: 3px;">$&</span>`);
            });
            
            return highlighted;
        }

        // Extract meaningful terms from product names
        function extractKeyTerms(name) {
            // Remove common words and split by various delimiters
            const commonWords = ['gb', 'mb', 'tb', 'ddr', 'ddr4', 'ddr5', 'nvme', 'sata', 'm.2', 'pcie'];
            const terms = name
                .toLowerCase()
                .replace(/[^\w\s]/g, ' ') // Replace non-alphanumeric with spaces
                .split(/\s+/)
                .filter(term => term.length > 1)
                .filter(term => !commonWords.includes(term));
            
            return [...new Set(terms)]; // Remove duplicates
        }

        // Simple Levenshtein distance for fuzzy matching
        function levenshteinDistance(a, b) {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;
            
            const matrix = Array(b.length + 1).fill().map(() => Array(a.length + 1).fill(0));
            
            for (let i = 0; i <= a.length; i++) matrix[0][i] = i;
            for (let j = 0; j <= b.length; j++) matrix[j][0] = j;
            
            for (let j = 1; j <= b.length; j++) {
                for (let i = 1; i <= a.length; i++) {
                    const cost = a[i - 1] === b[j - 1] ? 0 : 1;
                    matrix[j][i] = Math.min(
                        matrix[j - 1][i] + 1,     // deletion
                        matrix[j][i - 1] + 1,     // insertion
                        matrix[j - 1][i - 1] + cost // substitution
                    );
                }
            }
            
            return matrix[b.length][a.length];
        }

        // Escape regex special characters
        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        async function addMatch(specificationId, productId) {
            try {
                const response = await safeApiCall(`${baseURL}/api/specifications/${specificationId}/add-match/${productId}`, {
                    method: 'POST'
                });

                if (response.success) {
                    showAlert('success', 'Eşleşme başarıyla eklendi');
                    // Refresh both sides
                    loadCurrentMatches(specificationId);
                    const searchTerm = document.getElementById('potentialMatchSearch').value;
                    searchPotentialMatches(searchTerm);
                } else {
                    showAlert('error', response.error || 'Eşleşme eklenirken hata oluştu');
                }
            } catch (error) {
                console.error('Add match error:', error);
                showAlert('error', 'Eşleşme eklenirken hata oluştu: ' + error.message);
            }
        }

        async function removeMatch(specificationId, productId) {
            try {
                const response = await safeApiCall(`${baseURL}/api/specifications/${specificationId}/remove-match/${productId}`, {
                    method: 'DELETE'
                });

                if (response.success) {
                    showAlert('success', 'Eşleşme başarıyla kaldırıldı');
                    // Refresh both sides
                    loadCurrentMatches(specificationId);
                    const searchTerm = document.getElementById('potentialMatchSearch').value;
                    searchPotentialMatches(searchTerm);
                } else {
                    showAlert('error', response.error || 'Eşleşme kaldırılırken hata oluştu');
                }
            } catch (error) {
                console.error('Remove match error:', error);
                showAlert('error', 'Eşleşme kaldırılırken hata oluştu: ' + error.message);
            }
        }

        // Cleanup low quality matches
        // Otomatik eşleştirme fonksiyonları kaldırıldı - Manuel eşleştirme yeterli

        // Search functionality for potential matches
        let searchTimeout;
        function onPotentialMatchSearch() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                const searchTerm = document.getElementById('potentialMatchSearch').value;
                searchPotentialMatches(searchTerm);
            }, 300);
        }

        // Bulk selection functionality
        function toggleCurrentSelection(productId, element) {
            const checkbox = element.querySelector('.match-checkbox');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('selected');
            } else {
                element.classList.remove('selected');
            }
            
            updateCurrentSelectionCount();
        }

        function togglePotentialSelection(productId, element) {
            const checkbox = element.querySelector('.match-checkbox');
            checkbox.checked = !checkbox.checked;
            
            if (checkbox.checked) {
                element.classList.add('selected');
            } else {
                element.classList.remove('selected');
            }
            
            updatePotentialSelectionCount();
        }

        function selectAllCurrentMatches() {
            const matchItems = document.querySelectorAll('#currentMatches .match-item-selectable');
            matchItems.forEach(item => {
                const checkbox = item.querySelector('.match-checkbox');
                checkbox.checked = true;
                item.classList.add('selected');
            });
            updateCurrentSelectionCount();
        }

        function selectAllPotentialMatches() {
            const matchItems = document.querySelectorAll('#potentialMatches .match-item-selectable');
            matchItems.forEach(item => {
                const checkbox = item.querySelector('.match-checkbox');
                checkbox.checked = true;
                item.classList.add('selected');
            });
            updatePotentialSelectionCount();
        }

        function updateCurrentSelectionCount() {
            const selectedCount = document.querySelectorAll('#currentMatches .match-checkbox:checked').length;
            const countElement = document.getElementById('selectedCurrentCount');
            if (countElement) {
                countElement.textContent = selectedCount;
            }
        }

        function updatePotentialSelectionCount() {
            const selectedCount = document.querySelectorAll('#potentialMatches .match-checkbox:checked').length;
            const countElement = document.getElementById('selectedPotentialCount');
            if (countElement) {
                countElement.textContent = selectedCount;
            }
        }

        async function removeSelectedMatches() {
            const selectedCheckboxes = document.querySelectorAll('#currentMatches .match-checkbox:checked');
            if (selectedCheckboxes.length === 0) {
                showAlert('warning', 'Lütfen kaldırılacak eşleşmeleri seçin');
                return;
            }
            
            const confirmed = confirm(`${selectedCheckboxes.length} adet eşleşme kaldırılacak. Emin misiniz?`);
            if (!confirmed) return;
            
            let successCount = 0;
            let errorCount = 0;
            
            showAlert('info', `${selectedCheckboxes.length} eşleşme kaldırılıyor...`);
            
            for (const checkbox of selectedCheckboxes) {
                try {
                    const productId = checkbox.getAttribute('data-product-id');
                    const response = await safeApiCall(`${baseURL}/api/specifications/${currentSpecificationId}/remove-match/${productId}`, {
                        method: 'DELETE'
                    });
                    
                    if (response.success) {
                        successCount++;
                    } else {
                        errorCount++;
                        console.error('Remove match error:', response.error);
                    }
                } catch (error) {
                    errorCount++;
                    console.error('Remove match error:', error);
                    await new Promise(resolve => setTimeout(resolve, 100)); // Small delay between requests
                }
            }
            
            if (successCount > 0) {
                showAlert('success', `${successCount} eşleşme başarıyla kaldırıldı${errorCount > 0 ? `, ${errorCount} hata oluştu` : ''}`);
                loadCurrentMatches(currentSpecificationId);
                const searchTerm = document.getElementById('potentialMatchSearch').value;
                searchPotentialMatches(searchTerm);
            } else {
                showAlert('error', 'Hiçbir eşleşme kaldırılamadı');
            }
        }

        async function addSelectedMatches() {
            const selectedCheckboxes = document.querySelectorAll('#potentialMatches .match-checkbox:checked');
            if (selectedCheckboxes.length === 0) {
                showAlert('warning', 'Lütfen eklenecek ürünleri seçin');
                return;
            }
            
            const confirmed = confirm(`${selectedCheckboxes.length} adet ürün eşleştirilecek. Emin misiniz?`);
            if (!confirmed) return;
            
            let successCount = 0;
            let errorCount = 0;
            
            showAlert('info', `${selectedCheckboxes.length} ürün eşleştiriliyor...`);
            
            for (const checkbox of selectedCheckboxes) {
                try {
                    const productId = checkbox.getAttribute('data-product-id');
                    const response = await safeApiCall(`${baseURL}/api/specifications/${currentSpecificationId}/add-match/${productId}`, {
                        method: 'POST'
                    });
                    
                    if (response.success) {
                        successCount++;
                    } else {
                        errorCount++;
                        console.error('Add match error:', response.error);
                    }
                    await new Promise(resolve => setTimeout(resolve, 100)); // Small delay between requests
                } catch (error) {
                    errorCount++;
                    console.error('Add match error:', error);
                }
            }
            
            if (successCount > 0) {
                showAlert('success', `${successCount} ürün başarıyla eşleştirildi${errorCount > 0 ? `, ${errorCount} hata oluştu` : ''}`);
                loadCurrentMatches(currentSpecificationId);
                const searchTerm = document.getElementById('potentialMatchSearch').value;
                searchPotentialMatches(searchTerm);
            } else {
                showAlert('error', 'Hiçbir ürün eşleştirilemedi');
            }
        }
    </script>
</body>
</html>